REM:***Price Theory Programs Ver 1.1, May 2, 1991***REM:***Written by David D. Friedman***'Problems: Add cancel printing option? SW says laser printing problem. ???'Axis tool line sometimes leaves one black dot on axis.COORDINATE WINDOW:DEF MOUSE = 1DIM Yk&(462),Y1k&(462),Y2k&(462),Y3k&(462)DIM Ploc%(5),Rect(5),Screen(10200),Sprklr(10)DIM 63 B$(4),3 C$(4,4),22 MName$(3,4),2 Pfix$(5):DIM 18 TextScr$(12),16 HelpSize$DIM 9 Hlabel$,22 TextScr$,25 Title$,11 Txt$,3 Vlabel$,6 Vlabelrt$DIM Dflag(5),DRect(3),Ploc%(5),VRect(3),PtVRect(3),PtDRect(3):DIM Budlab(50),Cursr(11,33)DIM Markx(2,50),Marky(2,50)DIM Xc(10,200),Yc(10,200),I(22),MxI(50),MyI(50)DIM BLinex(50),BLiney(50),Lx(50),Ly(50),Lock(4),BVal!(50)DIM Linex1(20),Liney1(20),Linex2(20),Liney2(20),MxA(20),MyA(20)DIM 3 BLabl$(50),4 I$(10)DIM 5 Axis$,31 F$,3 Label$,6 Over$DIM Indcurve(4),CRect(4),RectLabel(5):REM: ,Penstate(9):DIM Y(462),Y1(462),Y2(462),Y3(462),YInt&(462)DIM X(270),Surplus&(462),Q(30),P(30),MC(30)DIM PupRect(4),ClpRect(4),ScrRect(4),PdownRect(4)DIM AxisTst(4),StWidth(10)DIM Plus(4),Minus(4)DIM 255 Atxt$,3 MVC$, PQuery$,2 Prefix$, 7 SorD$,6 LNbr$DIM 16 SorP$, 5 Y$DIM 65 Txt$(3):GOTO "StartMain" :REM: ***Interstellar bypass***:REM:_____________________ Beginning of Functions__________________:REM ***********************************************************DIALOG OFF:MENU OFF:MOUSE OFFLONG FN PhotoIF WINDOW(0)=0 OR Printing THEN RETURNGET (0,0)-(492,304),Screen(0) :REM ***Snapshot of Screen***END FNLONG FN RefreshPUT (0,0)-(492,304),Screen(0),PSET :REM ***Redo Screen***CALL DRAWCONTROLS(Wptr1&)END FNDIALOG OFF:REM ***********************************************************LONG FN AllMenu(First,State,Last)FOR Iam=First TO LastMHand&=FN GETMHANDLE(Iam)IF State=0 THEN CALL DISABLEITEM(MHand&,0)IF State=1 THEN  CALL ENABLEITEM(MHand&,0)NEXT IamCALL DRAWMENUBAREND FN:REM ***********************CallCurve**************************'                    ******Draws in a curve*******LONG FN Callcurve(CCveXmax)    :REM     ***Draws y up to Xmax***CURSOR 4PEN ,,,8:PLOT Xo,Y(Xo)FOR CCveI=Xo+1 TO CCveXmax-1 STEP 2PLOT TO CCveI,Y(CCveI)NEXT CCveICALL INITCURSOR:FN PhotoEND FN'DIALOG ON:MENU ON:MOUSE ONLONG FN ChangeCursor(TestCursor)LONG IF TestCursorCALL INITCURSOR XELSECALL SETCURSOR(Cursr(D1,0))END IFEND FN:'DIALOG OFF:MENU OFFMOUSE ON:DIALOG ONLONG FN Debounce WHILE M<>0M=MOUSE(0):M1=MOUSE(1):M2=MOUSE(2)FN ChangeCursor(M1<Xo-26 OR M1>Xh+26 OR M2<Yv-20 OR M2>Yo+28)WENDEND FNMOUSE OFF:DIALOG OFF:LONG FN DisposeOfMenusFOR I=HelpMenu TO 1 STEP -1 MHndl&=FN GETMHANDLE(I) IF MHndl&<>0 CALL DELETEMENU(MHndl&):CALL DISPOSEMENU(MHndl&)NEXT IEND FNLONG FN Enable(I)Mhndl&=FN GETMHANDLE(I):Item=FN COUNTMITEMS(Mhndl&)FOR J=0 TO Item:CALL ENABLEITEM(Mhndl&,J):CALL CHECKITEM(Mhndl&,J,0):NEXT JEND FNREM ***********************FillCurves*************************LONG FN Fillcurves(XFCi,XFCf)Surplus&=-FixedCost*SFactorInv+P*(XFCf-Xo)-YInt&(XFCf) IF XFCi=XFCf THEN GOTO "EndFillCurve"LONG IF XFCf>XFCiCALL SETRECT(PupRect(0),XFCi,0,XFCf,P) :REM  ***Defines rect above P**CALL SETRECT(PdownRect(0),XFCi,P,XFCf,350) :REM  ***Define rect below P**XELSECALL SETRECT(PupRect(0),XFCf,0,XFCi,P) :REM  ***Defines rect above P**CALL SETRECT(PdownRect(0),XFCf,P,XFCi,350) :REM  ***Define rect below P**END IFCALL RECTRGN(DownHand&,PdownRect(0)) :REM  ***Makes it a region***CALL RECTRGN(UpHand&,PupRect(0))  :REM  ***Makes it a region***CALL SECTRGN(UpHand&,YHand&,HighHand&)CALL DIFFRGN(DownHand&,YHand&,LowHand&)IF Prefix$="M" THEN Inset=2 ELSE Inset=1CALL INSETRGN(HighHand&,0,Inset):CALL INSETRGN(LowHand&,0,2)LONG IF XFCf>XFCiQmx=XFCf:Qmn=XFCiLONG IF Prefix$="D"CALL FILLRGN(HighHand&,Plus(0)):CALL FILLRGN(LowHand&,Minus(0))XELSECALL FILLRGN(HighHand&,Minus(0)):CALL FILLRGN(LowHand&,Plus(0))END IFXELSEQmx=XFCi:Qmn=XFCfCALL ERASERGN(HighHand&):CALL ERASERGN(LowHand&)END IFIF P>Yo-12 OR FN RECTINRGN(AxisTst(0),LowHand&) THEN GOSUB "ReDrawHAxis""EndFillCurve"FN PhotoEND FN:"ReDrawHAxis": REM ***A subroutine of FN  FillCurves***PEN 1,1,1,8BOX Xo,Yo TO Qmx,Yo+2:X=Xo+1+HScaleXmid=(Xo+Xh)/2LONG IF Qmx>Xmid AND Qmn<Xmid+54TEXT 4,9,1,1:PEN ,,,11BOX FILL Xmid-2,Yo-12 TO Xmid+2+FN STRINGWIDTH(Hlabel$),YoPRINT%(Xmid,Yo-3) Hlabel$;:PEN ,,,8END IFTEXT 1,9,0,1IF Qmx+10>Xh THEN Qmx=Xh ELSE Qmx=Qmx+10FOR I=1 TO (Qmx-Xo)/HScalePEN ,,,11'LNbr$=STR$(HNumber*I)BOX FILL X-10,Yscale+13 TO StWidth(I)+X,Yscale+2PRINT% (X-10,Yscale+12) HNumber*I;PEN ,,,8:BOX X,Yscale TO X+2,Yscale2X=X+HScaleNEXT IPEN ,,,10:TEXT 0,9,0,0RETURN::REM ***********************Label****************************LONG FN Label(TxtLab$,Xlab,Ylab,Fontlab,Sizelab,Facelab)TEXT Fontlab,Sizelab,Facelab,1:CALL PENNORMALCALL GETFONTINFO(Ploc%(0)):Dy=Ploc%(0)+Ploc%(1)+2Wlab=Xlab+3+FN STRINGWIDTH(TxtLab$):COLOR 0:BOX FILL Xlab,4+Ylab-Dy TO Wlab,Ylab+2 :COLOR -1PRINT% (Xlab+2,Ylab);TxtLab$;:BOX Xlab,Ylab+4-Dy TO Wlab,Ylab+2FN PhotoTEXT ,,,0:CALL PENNORMALEND FN::REM ****************************Mark*************************LONG FN Mark(XMk,YMk)PEN,,,8CIRCLE FILL XMk,YMk,3PEN ,,,8FN PhotoEND FN::REM **************************MarkX**************************LONG FN MarkX(XMk,YMk)PEN 2,2,,8:PLOT XMk-3,YMk-3 TO XMk+3,YMk+3PLOT XMk-3,YMk+3 TO XMk+3,YMk-3FN PhotoEND FN:'*****************MenuC(hange)*************LONG FN MenuC(MNbr,MItem,State) REM Changes MItem ON MENU MNbr TO State***MHand&=FN GETMHANDLE(MNbr)IF State=0 THEN CALL DISABLEITEM(MHand&,MItem)IF State=1 THEN  CALL ENABLEITEM(MHand&,MItem)IF State=2 THEN CALL CHECKITEM(MHand&,MItem,1) ELSE CALL CHECKITEM(MHand&,MItem,0)END FNREM ******************Message*********************LONG FN Message (Xmes,Ymes,Roffset,BOffset,LOffset,TOffset,Nmes,Font,Size,Face)REM: SHARED Ploc%():' ***if x=-1, this resets the eraser variables to 0.PEN 1,1,,11:BOX FILL X1eraser,Y1eraser TO X2eraser,Y2eraser:PEN ,,,8IF Xmes=-1 THEN  GOSUB "cancel":RETURNTEXT Font,Size,Face,1Xright=Xmes:Ybottom=YmesCALL GETFONTINFO(Ploc%(0)):YSize=Ploc%(0)+Ploc%(1)+1FOR I=1 TO NmesYbottom=Ybottom+YSize:PRINT%(Xmes+5,Ybottom) Txt$(I);CALL GETPEN(Ploc%(0)):IF Ploc%(1)>Xright THEN  Xright=Ploc%(1)NEXT IXmes=Xmes-LOffset:Ymes=Ymes-TOffset: REM     ***This redefines xmes,ymes***X1eraser=Xmes-1:Y1eraser=Ymes-1X2eraser=Xright+Roffset+6:Y2eraser=Ybottom+BOffset+8BOX Xmes-1,Ymes-1 TO X2eraser,Y2eraserBOX Xmes,Ymes TO X2eraser-1,Y2eraser-1Roffset=X2eraser-Xmes:BOffset=Y2eraser-Ymes :REM     ***Returns xmes,ymes,Deltax,Deltay, in first***:REM                           ***Four places. These represent the entire rectangle used***TEXT 1,12,1,0           :REM  ***This Restores Text output***FN Photo                      REM ***To its default values***END FN:"cancel":   REM   *****A subroutine of FN Message****X1eraser=0:X2eraser=0:Y1eraser=0:Y2eraser=0RETURN::REM ***********************************************************:REM     *******This uses the mouse to move a horizontal line or box*********:REM      ******In order to set and mark a vertical value such as price******MENU ON:MOUSE ON:DIALOG ONLONG FN SetVert(XoSV,YiSV,XmSV,DySV,RepeatflagSV)UpBOUND=Yo+30:LowBOUND=Yv+5IF RepeatflagSV=0 THEN  PEN 1,DySV,,10:GOSUB "AxisClick.DMV"Txt$(1)="Click and drag above or below to move the"Txt$(2)=Txt$+". When you are satisfied, double click."FN Message (100,2,0,0,0,0,2,1,12,0)PEN 1,DySV,,10:CALL INITCURSORM=0WHILE (M<>2 AND M<>-2) AND NOT ExitM=MOUSE(0):Yold=YiSV'MENU STOPLONG IF M<0YiSV=YiSV+Rate!*(MOUSE(2)-YiSV)IF YiSV>UpBOUND THEN YiSV=UpBOUND ELSE IF YiSV<LowBOUND THEN YiSV=LowBOUNDYUp=YiSV-Dyhalf:YDown=YUp+DySV'END IFPLOT XoSV,Yold TO XmSV,Yold:PLOT XoSV,YiSV TO XmSV,YiSV:FN PhotoEND IFMENU ONWENDEND FN=YiSV:"AxisClick.DMV": REM*******A subroutine of SetVert*********RepeatflagSV=1Txt$(1)="Click on "+ Y$+" axis to set the "+Txt$+"."FN Message (135,10,0,0,0,0,1,1,12,0)PEN 1,DySV,,10:M=MOUSE(0)WHILE (MOUSE(0)=0 OR MOUSE(4)>UpBOUND OR MOUSE(4)<LowBOUND OR ABS(MOUSE(3)-Xclick)>15) AND NOT ExitWENDYiSV=MOUSE(2):PLOT XoSV,YiSV TO XmSV,YiSV:FN PhotoRETURNMENU OFF:MOUSE OFF:DIALOG OFFREM ****Define the functions for Indifference curves 6-10*****DEF FN Y6(X,Uk&)=(VScale*Uk&-VHRatK*X)/(1024+((X*HInvKK&)>>10)):REM *** FNx and FNy are ****DEF FN U6k&(X,Y)=(X*HInvKK&+Y*VInvKK&+X*Y*VHProdInvKK)>>10: REM*** numbers of points on*** DEF FN X6!(Y,Uk&)=(HScale*Uk&-HVRatK*Y)/(1024+((Y*VInvKK&)>>10)): REM***the screen       ***DEF FN Y7(X,Uk&)=(VScale<<10)/(((X*HInvKK&)>>10)-Uk&)DEF FN U7k&(X,Y)=((X*HInvKK&)>>10)-((VScale<<10)/Y)DEF FN X7!(Y,Uk&)=(HScale*Uk&+VHProdK&/Y)>>10DEF FN Y8(X,Uk&)=(Uk&*VHProd)/(X<<10)DEF FN U8k&(X,Y)=(X*Y*VHProdInvKK)>>10DEF FN X8!(Y,Uk&)=(Uk&*VHProd)/(Y<<10)DEF FN Y9(X,Uk&)=(Uk&*VScale-X*VHRatK)>>10DEF FN U9k&(X,Y)=(X*HInvKK&+Y*VInvKK&)>>10DEF FN X9!(Y,Uk&)=(HScale*Uk&-((HScale*Y*VInvKK&)>>10))>>10DEF FN Y0(X,Uk&)=(VScale*Uk&-X*VHRatK)/(2048+(X*HInvKK&>>10))DEF FN U0k&(X,Y)=(X*HInvKK&+2*Y*VInvKK&+(X*Y*VHProdInvKK))>>10DEF FN X0!(Y,Uk&)=HScale*((Uk&<<10)-2*Y*VInvKK&)/(1048576+Y*VInvKK&):::REM ****************Wait for Button FN**************************LONG FN WaitForButtonFN Photo:D0=0DIALOG ON:MENU ONWHILE D0<>1 AND NOT Exit'WHILE DIALOG(0)<>1 AND NOT ExitWENDEND FNDIALOG OFF:MENU OFF::REM ************WARNING Function*****************LONG FN Warning(ANbr,Alrt$)FN Photo :REM ***Snapshot of Screen***ON ANbr GOSUB "EraseWng","AppleMenu","NoIWng","NoMore","PrintWarning","PrintWarning2"IF ANbr=2 THEN GOTO "ending"CALL PARAMTEXT(B$(1),B$(2),B$(3),B$(4))IF ANbr=1 THEN Warningchoice=FN CAUTIONALERT(4,0)'IF ANbr=2 THEN Warningchoice=FN NOTEALERT(1,0)IF ANbr>2 THEN Warningchoice=FN STOPALERT (1,0)FN Refresh:REM       ***Redraws Screen***"ending"END FN=Warningchoice:"EraseWng"B$(1)= "Carrying out this operation will"B$(2)="erase "+Alrt$+"."B$(3)=""B$(4)="Is this what you want?"RETURN:"AppleMenu"FN PhotoWINDOW#4,"About Price Theory",(20,50)-(300,150),4:TEXT 3,12PRINT@(4,1)"This program accompanies":TEXT ,,2PRINT@(2,2)"Price Theory: An Intermediate Text":TEXT ,,0PRINT@(5,3)"  by David Friedman."PRINT@(3,4)" For more information, select"PRINT@(2,5)"  Instructions from the Help Menu."MOUSE ON:M=MOUSE(0):D0=0:Applewindow=-1WHILE M=0 AND D0=0M=MOUSE(0)WENDMOUSE OFFWINDOW CLOSE #4FN Refresh:Applewindow=0RETURN:"NoIWng"B$(1)="You must choose an"B$(2)="indifference curve map from the"B$(3)="I map menu before you can"B$(4)="draw an indifference curve"RETURN:"NoMore"B$(1)= "I cannot draw more "B$(2)=Alrt$B$(3)=""B$(4)="To draw more, first erase some."RETURN:"PrintWarning"B$(1)="You cannot print an indifference"B$(2)="curve/budget line diagram in "B$(3)="draft mode."B$(4)=""RETURN:"PrintWarning2"B$(1)="Make sure the Imagewriter is"B$(2)="turned on and connected, and"B$(3)="the correct port is chosen."B$(4)=""RETURN:REM *********************WhileMouseUp***********************MOUSE ON:DIALOG ON:MENU ONLONG FN WhileMouseUpWHILE M=0 AND NOT ExitM=MOUSE(0)WENDEND FN:MOUSE OFF:MENU OFF:DIALOG OFFREM:_____________________ End of Functions__________________:"StartMain"GOSUB "WindowPosn":GOSUB "NewRegions.Mn"WINDOW CLOSE 1WINDOW 1,"Price Theory",(Wind1L,Wind1T)-(Wind1L+492,Wind1T+304),261:FN PhotoWptr1&=WINDOW(14)ON DIALOG GOSUB "Dialog Event"FontSize=9:HelpSize$="Larger Print"GOSUB "Copyright Screen":GOSUB "NewRegions.Mn":DEFSTR LONGF$="":Count%=1:True=(1=1):False = NOT True:SetupFlag=FalseA% =FINDERINFO(Count%,F$,Type&,Vol%)DEFSTR WORDLONG IF F$<>""DLoad=-2:D1=0:Module=2XELSEGOSUB "Initialize.Main"FN MenuC(ControlMenu,0,0):FN MenuC(HelpMenu,0,0):MENU 255,0,0Title$="Instructions":TextScr$="Instructions.Mn":GOSUB "Printtext"FN MenuC(ControlMenu,0,1):FN MenuC(HelpMenu,0,1):MENU 255,0,1END IF'APPLE MENU "About Price Theory":MENU ON:BREAK ONREM:########################Main Event Loop####################"SquirrelCage"Menu1=0:Exit=0:ON Module GOSUB "StartCurveDraw","ClearStart","StartLineDMV"IF Module>3 THEN GOSUB "Initialize.Main"GOTO "SquirrelCage"ENDREM:###########################End of Loop####################MENU OFF:DIALOG ON:BREAK OFF"WindowPosn"'LONG IF WINDOW(0)=0Wind1L=10:Wind1T=40:'***Setting position of initial window***Wind3L=44:Wind3T=50: '***Setting position of help window***'XELSE'IF WINDOW(0)=1 THEN Wind1L=-WINDOW(10):Wind1T=-WINDOW(11)'END IFRETURN:DIALOG OFF"NewRegions.Mn"'CtRegion&=0:CtRegion&=FN NEWRGN        REM   ***to store current region when necessary***UpHand&=0:DownHand&=0:HighHand&=0:LowHand&=0:YHand&=0:DHand&=0:Draw&=0.UpHand&=FN NEWRGN:DownHand&=FN NEWRGNHighHand&=FN NEWRGN:LowHand&=FN NEWRGN YHand&=FN NEWRGN:DHand&=FN NEWRGNDraw&=FN NEWRGN: REM   ***the drawing screen as draw***OldRegion&=0.:OldRegion&=FN NEWRGNRETURN"CloseRegions.Mn"CALL DISPOSERGN(UpHand&):CALL DISPOSERGN(DownHand&)CALL DISPOSERGN(HighHand&):CALL DISPOSERGN(LowHand&)CALL DISPOSERGN(YHand&):CALL DISPOSERGN(DHand&)CALL DISPOSERGN(OldRegion&):CALL DISPOSERGN(Draw&)CALL DISPOSERGN(CtRegion&)RETURN"Initialize.Main"Module=0'IF FontSize=9 THEN HelpSize$="Larger Print" ELSE HelpSize$="Smaller Print"CALL CLEARMENUBARLONG IF MBhndlMn&=0APPLE MENU "About Price Theory"ControlMenu=1:Mhndl&=FN NEWMENU (ControlMenu,"Control"):CALL APPENDMENU(Mhndl&,"Curve Draw/C;BI Draw/B;DSM/D;Quit/Q")CALL INSERTMENU(Mhndl&,0)'FOR I=2 TO 6:Mhndl&=FN NEWMENU(I,"        "):CALL INSERTMENU(Mhndl&,0):NEXT IFOR I=2 TO 6:Mhndl&=FN NEWMENU(I,""):CALL INSERTMENU(Mhndl&,0):NEXT IHelpMenu=7:Mhndl&=FN NEWMENU(HelpMenu,"Help")HMenu$="Instructions/I;About Curve Draw;About BI Draw;About DSM;"+HelpSize$CALL APPENDMENU(Mhndl&,HMenu$)CALL INSERTMENU(Mhndl&,0)MBhndlMn&=FN GETMENUBARXELSECALL SETMENUBAR(MBhndlMn&)END IFCALL DRAWMENUBARON MENU GOSUB "MenuSub.Main"   :REM    ***Activitating the Menu***RETURN"Copyright Screen"TEXT 0,12,0,0:PRINT@(8,1)"PRICE THEORY: An Intermediate Text":TEXT 1,12:PRINT@(11,2)"by David D. Friedman":TEXT 1,9:PRINT%(210,62)"HC65BH71G"PRINT@(2,6)"© by South-Western Publishing Co., Cincinnati, OH"PRINT@(2,8)"ISBN: 0-538-80566-8"PRINT@(2,9)"Ver 1.1  5/91"PRINT@(2,10)"Produced in the United States of America"PRINT@(2,12)"This software was created using the ZBasicª Compiler."PRINT@(2,13)"Portions of this code are © Copyrighted, 1985,1986,1987,1988 by Zedcor, Inc."PRINT@(2,15)"The use of this software/data is governed by the terms of a nonexclusive and nontransferable"PRINT@(2,16)"license agreement. The software/data may not be revised, translated, converted, disassembled,"PRINT@(2,17)"or otherwise reverse engineered. You may not copy, sell, license, lease, rent, loan, or otherwise"PRINT@(2,18)"distribute or network the software/data except that you may make copies for students in a course"PRINT@(2,19)"for which PRICE THEORY: An Intermediate Text is a required text to use at their educational"PRINT@(2,20)"institution(s) or temporarily at home."TEXT 1,9,1:PRINT@(12,22)"Click the mouse button to continue":FN PhotoMOUSE ON:DIALOG ONWHILE M=0M=MOUSE(0)WENDMOUSE OFF:DIALOG OFF:CLSRETURN:"MenuSub.Main"MENUFN MenuC(ControlMenu,0,0):FN MenuC(HelpMenu,0,0):FN MenuC(255,0,0)Menuzero=MENU(0):Menu1=MENU(1)IF Menuzero=255 THEN CALL DRAWMENUBAR:WChoice=FN Warning(2,"") IF Menuzero=ControlMenu THEN GOSUB "Control.Main"IF Menuzero=HelpMenu THEN GOSUB "Help.Main"FN MenuC(ControlMenu,0,1):FN MenuC(HelpMenu,0,1):FN MenuC(255,0,1):CALL DRAWMENUBARRETURN:"Control.Main"IF Menu1=4 THEN GOSUB "CloseRegions.Mn":ENDModule=Menu1RETURN:"Help.Main"IF Menu1=1 THEN Title$="Instructions":TextScr$="Instructions.Mn"IF Menu1=2 THEN Title$="Instructions Curve Draw":TextScr$="Instructions.CVE"IF Menu1=3 THEN Title$="Instructions B/I Draw":TextScr$="Instructions.Bid"IF Menu1=4 THEN Title$="Instructions D,S,M":TextScr$="Instructions.DMV"IF Menu1=5 THEN GOSUB "ChangeFontSize" ELSE CALL DRAWMENUBAR:GOSUB "Printtext"RETURN:"ChangeFontSize"LONG IF FontSize=9 FontSize=12:HelpSize$="Smaller Print"XELSEFontSize=9:HelpSize$="Larger Print"END IF'IF Module=3 THEN MENU 6,5,1,HelpSize$ ELSE MENU 7,5,1,HelpSize$MENU HelpMenu,5,1,HelpSize$  '!!!New Change-old line aboveRETURN'********DIALOG Event Subroutine***"Dialog Event" D0=DIALOG(0):DN=DIALOG(D0)IF Applewindow=-1 THEN RETURNIF D0=1 THEN D1=DN:IF D1=13 THEN GOSUB "Scroll it" 'Returns button number pushed as D1IF D0=3 THEN WINDOW DN:IF DN=1 THEN Reading=0IF D0=4 THEN Reading=0LONG IF D0=5LONG IF TEStatus=-1CALL TEUPDATE(VRect(0),TeHndl&)IF DN=1 THEN WINDOW OUTPUT 1:FN Refresh:WINDOW OUTPUT 3XELSEIF TEStatus=0 THEN FN RefreshEND IF END IFRETURN"null event"RETURN:REM   *****************CurveDraw Module****************:REM "StartCurveDraw":GOSUB "Initialize.CVE":Menuflag=1:Exit=0:StartOver=0MChoice=0MOUSE ON:MENU ON:DIALOG ONON MENU GOSUB "MenuSub.CVE":   REM   ***Activitating the Menu***'ON DIALOG GOSUB "Dialog Event":BREAK ONREM:##############Main Event Loop for Curve Draw Module=1###############"TreadMill": REM ***This Whole Fershlugginer program is one endless loop***Xmax=Xh:DHelp=1IF MChoice<>0 THEN  GOSUB "CurveDraw.CVE"IF NOT Exit THEN GOTO "TreadMill"CLS:FN PhotoTEXT 0,12,,0CALL PENNORMALCALL INITCURSORLONG IF StartOver=-1Module=1:GOTO "StartCurveDraw"XELSEModule=9:RETURN END IFBREAK OFFREM:##############End of Main Event Loop for Curve Draw###############:MENU OFF:MOUSE OFF:DIALOG OFF:REM *******************************************************:REM        ***Subroutines for the Main Program Start Here***:REM ****************************************************REM *************************SPARKLER***********************"Sparkler"PLOT 400,5 TO 406,5:PLOT 401,3 TO 405,7:PLOT 401,7 TO 405,3GET (400,3)-(406,7),Sprklr(0):CLSRETURN:SEGMENT:REM ****************Initialize*************************"Initialize.CVE":CURSOR=4GOSUB "SetMenu.CVE":REM      ***Setting up the Menu***GOSUB "Sparkler":       REM ***Defining the Sparkler***RESTORE:REM            ***Sets reading of data back to first item***FOR I=1 TO 3:FOR J=0 TO 3:READ MName$(I,J):NEXT J:NEXT I:DATA Cost,Draw Total Cost,Draw Marginal Cost,Draw Average Cost:DATA Revenue,Draw Total Revenue,Draw Marginal Revenue,Draw Demand Curve:DATA Value,Draw Total Value,Draw Marginal Value,FOR M=1 TO 3:FOR C=1 TO 3:READ C$(M,C):NEXT C:READ Pfix$(M):NEXT M:DATA TC,MC,AC,C,TR,MR,D,R,TV,MV,AV,VFOR I=1 TO 4:READ TextScr$(I):TextScr$(I)="Help"+TextScr$(I):NEXT I:DATA Choice,FCost,Draw,ReviewXo=28:Yo=225:Xh=451:Yv=50:Ylow=295:Hlabel$="Quantity": REM ***Setting**XoK&=Xo<<10:YoK&=Yo<<10HScale=50:VScale=50:HNumber=10:VNumber=20:     REM ***the axis parameters**Vnumberrt!=1MCFactor!= (VNumber*HScale)/(HNumber*Vnumberrt!):MCFactor=MCFactor!:MCFactorK&=MCFactor<<10Rate!=.05:RateInv=20    :REM  ***Sets the rate for dragging curve***FCDelay=6:DelayC=6:DelayC2=6  :REM  ***Delay for  messages, first time through**'Oldregion!=0:Draw!=0                REM ***defines the whole screen as oldregion,CALL GETCLIP(OldRegion&)CALL SETRECT(Rect(0),Xo,Yv,Xh,Ylow)CALL RECTRGN(Draw&,Rect(0))CALL INITCURSOR:REM           ***Returns cursor to normal shape***SEGMENT RETURNSEGMENT::REM ***********************************************************:REM          ***This polls the menu and branches accordingly***"MenuSub.CVE":MENU:REMMenuzero=MENU(0)IF Menuzero=255 THEN WChoice=FN Warning(2,"")Test=Menuzero<6 AND Menuzero>2IF Test THEN  FN MenuC(HelpMenu,2,ControlMenu):MChoice=Menuzero-2:Cchoice=MENU(1)' MENU OFFON Menuzero GOSUB "Control.CVE","Null","CSetup","RSetup","VSetup","Null","HelpMenu.CVE"RETURN  :REM ***Goes to whichever menu was selected, then returns**:REM ************These are the menu selections, each with its subroutines***:"Null":RETURN:"Control.CVE":Menu1=MENU(1):ON Menu1 GOSUB "StartOver.CVE","OtherProgram.CVE","Quit"RETURN::REM ************These Are the Alternatives on the Main Menu*************"StartOver.CVE":Exit=-1:StartOver=-1CALL SETCLIP(OldRegion&)RETURN:"Quit":GOSUB "CloseRegions.Mn"ENDRETURN:"OtherProgram.CVE":Exit=-1CALL SETCLIP(OldRegion&)RETURN:REM *********These are the module choice subroutines*************"CSetup":FN MenuC(4,0,0)FN MenuC(5,0,0):Cmax=3:GOSUB "Menufix":REM ***choice checked,others disabledVlabel$="TC":Vlabelrt$="MC AC":CALL DRAWMENUBARRETURN"RSetup":FN MenuC(3,0,0):FN MenuC(5,0,0):Cmax=3:GOSUB "Menufix": REM ***choice checked,others disabledVlabel$="TR":Vlabelrt$="MR D":CALL DRAWMENUBARRETURN:"VSetup":FN MenuC(3,0,0):FN MenuC(4,0,0):Cmax=2:GOSUB "Menufix": REM ***choice checked,others disabledVlabel$="TV":Vlabelrt$="  MV":Dflag(3)=0:CALL DRAWMENUBARRETURN:"Menufix":FOR Imfx=1 TO CmaxIF I<>Cchoice THEN  FN MenuC(MChoice+2,Imfx,0) ELSE  FN MenuC(MChoice+2,Imfx,2)NEXT ImfxRETURN::REM *******This is the help menu, with subroutines*********"HelpMenu.CVE":FN AllMenu(1,0,7)IF Viewflag THEN  CALL SETCLIP(OldRegion&)'MENU ONMenu1=MENU(1):ON Menu1 GOSUB "Instruction.CVE","Help.CVE","MacHints.CVE","Projects.CVE"'MENU OFFIF Menu1=5 THEN GOSUB "ChangeFontSize" ELSE GOSUB "Printtext"FN MenuC(HelpMenu,0,1):FN MenuC(ControlMenu,0,1)IF MChoice=0 THEN FN AllMenu(3,1,5) ELSE  FN MenuC(MChoice+2,0,1):CALL DRAWMENUBARIF Viewflag THEN  CALL SETCLIP(Draw&)RETURN::REM **************These are the Alternatives on the Help Menu*********"Instruction.CVE":Title$="Instructions":TextScr$="Instructions.cve"RETURN:"Help.CVE":IF DHelp=1 THEN Title$="Help":TextScr$="HelpChoice.cve":RETURNIF DHelp=2 THEN Title$="Help":TextScr$="HelpFCost.cve":RETURNTitle$="Help":TextScr$=Pfix$(MChoice)+TextScr$(DHelp)+".cve"RETURN:"MacHints.CVE":Title$="MacHints":TextScr$="MacHints"RETURN:"Projects.CVE":IF MChoice=0 THEN  Title$="Projects":TextScr$="Projects.cve":RETURNTitle$="Projects":TextScr$=Pfix$(MChoice)+"Projects.cve"RETURN:REM ************************************************************:REM ****************End of the Menuchoice subroutines *****************::REM **********************************************************:REM ************This is really the main program of Curvedraw************:REM ***********************************************************"CurveDraw.CVE":CLS:Xclick=XoGOSUB "Axis":IF MChoice=1 THEN  GOSUB "SetFixedCost" ELSE  Fc=YoDHelp=3            :REM ***changes help screen***IF Exit THEN RETURNTxt$(1)="Select the curve or curves that you want me to draw"Firstchoice=-1:GOSUB "CurveButtons":Firstchoice=0GOSUB "showlinestyles"GOSUB "make3curves"IF Exit THEN RETURNGOSUB "Labelcurves"GOSUB "Seeagain"IF Exit THEN RETURNDHelp=4    :REM ***Changes Help Screen***WHILE RptFlag AND NOT Exit:REM ***Starts loop for looking at selections of curves***GOSUB "Axis"Txt$(1)="              Choose the curves you want to see.              "BUTTON CLOSE 1:BUTTON CLOSE 2:FN PhotoGOSUB "CurveButtons":CALL PENSIZE(2,2):CALL PENMODE(8)IF Exit THEN RETURNMENU OFF:DIALOG OFF:MOUSE OFFViewflag=-1:CALL SETCLIP(Draw&):       REM ***starts clipping to draw region***IF Dflag(1) AND Xmax>Xo+2 THEN PEN 2,2:GOSUB "CDrawTC":PEN 1,1IF Dflag(2) AND Xmax>Xo+2 THEN  PEN 1,1:GOSUB "CDrawMC"IF Dflag(3) AND Xmax>Xo+1 THEN PEN 1,1:FOR I=Xo TO Xmax STEP 2:PLOT I,(Y3k&(I)>>10):NEXT IGOSUB "Labelcurves"CALL SETCLIP(OldRegion&):Viewflag=0:'CALL SETCLIP(OldRegion&):      REM ***undoes clipping***GOSUB "showlinestyles":FN PhotoMENU ONGOSUB "Seeagain"WEND   :REM  ***Ends loop for looking at selections of curves***Txt$(1)="You may now draw another curve or quit. "Txt$(2)="Choose your alternative from the appropriate menu."FN Message(80,5,0,0,0,0,2,1,12,0)MENU ON:MOUSE ON:DIALOG ONGOSUB "SetMenu.CVE"MChoice=0RETURN:REM **********************************************************:"SetFixedCost":DHelp=2   :REM ***Changes Help Screen***Txt$(1)="Do you want any fixed cost?":Dy=15BOffset=Dy:FN Message(150,4,0,BOffset,0,0,1,1,12,0):Dy=BOffsetBUTTON 1,1,"Yes",(200,Dy-13)-(240,Dy),2BUTTON 2,1,"No",(260,Dy-13)-(300,Dy),2DIALOG ON:D0=0:D1=0:WHILE D0<>1 AND NOT ExitWENDDIALOG OFFBUTTON CLOSE 1:BUTTON CLOSE 2:FN PhotoIF D1=2 THEN  Fc=Yo:RETURNTxt$="Fixed Cost":Yis=Yo-20GOSUB "SetVert"Fc=Yis:BOX FILL Xo-8,Fc-2 TO Xo-4,Fc+2RETURN:"CurveButtons":Dy=17:BOffset=Dy:FN Message(75,4,0,BOffset,0,0,1,1,12,0):Dy=BOffsetBUTTON 1,1,C$(MChoice,1),(85,Dy-13)-(125,Dy),2BUTTON 2,1,C$(MChoice,2),(135,Dy-13)-(175,Dy),2IF MChoice<>3 THEN  BUTTON 3,1,C$(MChoice,3),(185,Dy-13)-(225,Dy),2IF Firstchoice THEN  BUTTON Cchoice,0,C$(MChoice,Cchoice)BUTTON 4,1,"OK",(335,Dy-13)-(395,Dy),1D1=5WHILE D1<>4 AND NOT ExitDIALOG ONWHILE D0<>1 AND NOT ExitWENDIF D1<5 THEN IF BUTTON(D1)=2 THEN  BUTTON D1,1,C$(MChoice,D1) ELSE  BUTTON D1,2,C$(MChoice,D1)WENDFOR I=1 TO Cmax:Dflag(I)=(BUTTON(I)=2):BUTTON CLOSE I:NEXT I:FN PhotoDIALOG OFFBUTTON CLOSE 4:IF Firstchoice THEN  Dflag(Cchoice)=-1BOffset=Dy:Ns=1:FN Message(-1,4,0,BOffset,0,0,1,1,12,0): REM ***clears message area***RETURN:"showlinestyles":IF Dflag(1) THEN  BOX 60,9 TO 160,11:FN Label(C$(MChoice,1),60,15,0,12,0)IF Dflag(2) THEN  PLOT 60,25 TO 160,25:FN Label(C$(MChoice,2),100,30,0,12,0)IF Dflag(3) THEN  FOR I=60 TO 150 STEP 2:PLOT I,40:NEXT IIF Dflag(3) THEN  FN Label(C$(MChoice,3),143,45,0,12,0)RETURN:"Labelcurves":Ys=(Y1k&(Xo)>>10)+5:GOSUB "Cliplabel"IF Dflag(1) THEN  FN Label(C$(MChoice,1),Xo,Ys,0,12,0)Xs=(Xo+Xmax)/2:Ys=(Y2k&(Xs)>>10)+5:GOSUB "Cliplabel"IF Dflag(2) THEN  FN Label(C$(MChoice,2),Xs,Ys,0,12,0)Ys=(Y3k&(Xmax)>>10)+5:GOSUB "Cliplabel"IF Dflag(3) THEN  FN Label(C$(MChoice,3),Xmax,Ys,0,12,0)RETURN:"Cliplabel":IF Ys<Yv+10 THEN  Ys=Yv+10 ELSE  IF Ys>Ylow-5 THEN  Ys=Ylow-5RETURN:"Seeagain":Txt$(1)="Do you want to see a selection of"Txt$(2)="the curves?"FN Message(210,4,0,4,0,0,2,1,12,0)BUTTON 1,1,"Yes",(337,22)-(364,42),1BUTTON 2,1,"No",(379,22)-(406,42),1DIALOG ONWHILE D0<>1 AND NOT ExitWENDCLS:RptFlag=(D1=1):BUTTON CLOSE 1:BUTTON CLOSE 2:FN PhotoDIALOG OFFRETURNMENU OFF:MOUSE OFF:DIALOG OFF:"CDrawTC":CALL MOVETO (Xo,(Y1k&(Xo)>>10))FOR I=Xo+3 TO Xmax-4 STEP 5CALL LINETO(I,(Y1k&(I)>>10))NEXT IRETURN:"CDrawMC":CALL MOVETO (Xo,(Y2k&(Xo)>>10))FOR I=Xo+3 TO Xmax-4 STEP 5CALL LINETO(I,(Y2k&(I)>>10))NEXT IRETURN:MENU OFF:MOUSE OFF:DIALOG OFF:REM **********************************************************:SEGMENT:REM **********************************************************:REM ******************This Finishes the menu choice routines************:REM ***********************************************************::REM **********************************************************:REM *****************This Starts what used to be Subprograms*******************:REM **********************************************************::REM **********************************************************:REM *************************Axis*****************************:REM ***Draws in an axis; (xo,yo) is the origin. HScale is the number of dots per***:REM ***mark, Hnumber the number by which each mark increments quantity.****REM  Axis (xo,yo,xh,yv,hlabel$,Vlabel$,HScale,VScale,HNumber,VNumber) "Axis"NHoriz=(Xh-Xo)/HScale:NVert=(Yo-Yv)/VScaleY=Yo+VScale:X=Xo+1+HScaleXscale=Xo-8:Yscale=Yo+9:Xscale2=Xo-3:Yscale2=Yo+2Xscale3=Xh+3:Xscale4=Xh+8TEXT 1,9,0,1:CALL PENNORMAL:REM         ***Next four lines draw and label the marks on the axes****FOR I=-1 TO NVertPRINT%(Xscale-20,Y+3) USING"###"; VNumber*I;:BOX Xscale,Y-1 TO Xscale2,Y+1LONG IF Module=1PRINT%(Xscale4+1,Y+1) USING"##.#"; Vnumberrt!*I;:BOX Xscale3,Y-1 TO Xscale4,Y+1END IFY=Y-VScaleNEXT IFOR I=1 TO NHorizPRINT% (X-10,Yscale+12) HNumber*I;BOX X,Yscale TO X+2,Yscale2X=X+HScaleNEXT IPEN 4,4:PLOT Xo-4,Yv-5 TO   Xo-4,298 TO  Xh,298 TO Xh,Yv TO Xo-4,YvREM **These  lines draw  bottom framePLOT TO Xo-4,Yv:BOX Xo-4,Yo TO Xh,Yo+2IF Module=1 THEN PLOT Xh,Yv TO Xh,Yv-8:REM Extension to right hand vertical axis:REM               *** Next lines label the axes***TEXT 4,9,1PRINT%((Xo+Xh)/2,Yo-3) Hlabel$;IF Module=3 THEN PRINT%((Xo-12),(Yv-9)) Vlabel$+MVC$ ELSE PRINT%((Xo-8),(Yv-9)) Vlabel$;IF Module=1 THEN PRINT%((Xh-15),(Yv-9)) Vlabelrt$;: REM ***VLabelrt???***TEXT 1,12,0:CALL PENNORMAL:FN PhotoSEGMENT RETURNSEGMENT::REM **********************************************************:REM ***********************Make3Curves*************************:REM *** Uses mouse to draw y=f(x). If Horizdir>o, draw left to right; horizdir****:REM ***gives the minimum delta x which is recognized. If Vertdir>0, only an****:REM ***increasing function is recognized, if <0 only decreasing, if =0, both.****:REM ***Note:This version is only debugged for Horizdir>0,Vertdir=0*****:REM SUB make3curves(yi,xmax)":REM SHARED Y!(),Y1!(),Y2!(),Y3!(),dflag(),mchoice,cchoice,yo,yv,xo,fc,MCFactor!"StartCurve.CVE":X=Xo:Y1k&(Xo)=Fc<<10:Y3k&(Xo)=YoK&+((300<<10)*SGN(Fc-Yo))LONG IF Cchoice=1Yk&(Xo)=Fc<<10:Y2k&(Xo)=YoK&+(My-Fc)*MCFactorK&/(Mx-Xo)XELSEYk&(Xo)=(My<<10):IF Cchoice=2 THEN Y2k&(Xo)=Yk&(Xo) END IFIF Fc=Yo AND Cchoice=3 THEN  Yk&(Xo)=(My<<10):Y2k&(Xo)=(My<<10)IF Fc<>Yo AND Cchoice=3 THEN Yk&(Xo)=Y3k&(Xo):GOSUB "SetMCofZero"Yk&=Yk&(Xo):Y1k&=(Fc<<10):Y1k&(Xo)=Y1k&IF MChoice=2 AND Cchoice=3 THEN  NotD=0 ELSE  NotD=-1:REM ***drawing D?***RETURN:"SetMCofZero":REM:IF Fc=Yo THEN  Y2k&(Xo)=((My-Fc)/(Mx-Xo)+Yo)<<10:RETURN'Slope!=(My-Y3!(Xo))/(Mx-Xo-1)SlopeK&=((My<<10)-Y3k&(Xo))/(Mx-Xo-1)Y2k&(Xo)=Y3k&(Xo)+2*SlopeK&RETURN:MOUSE OFF:MENU OFF:DIALOG OFF"Extendline3":Increment=ABS(Deltax)/RateInv:IF Increment=0 THEN RETURNXold=X:Xoldp=X+1:YoldK&=Yk&:DeltaSlopeK&=DeltayK&/DeltaxFOR I=0 TO IncrementX=X+1:Yk&=Yk&+DeltaSlopeK&IF X>Xmax  THEN  X=X-1:Yk&=Yk&(X):I=Increment ELSE  Yk&(X)=Yk&NEXT I:REM ***Calculate next point***IF X<>Xold THEN  ON Cchoice GOSUB "TCDraw","MCDraw","ACDraw" ELSE RETURNCALL SETCLIP(Draw&)LONG IF Dflag(1)PEN 2,2 PLOT Xold,(Y1k&(Xold)>>10) TO X,(Y1k&(X)>>10) PEN 1,1END IFTest=Dflag(2) AND (Cchoice<>2)'IF Test THEN  PLOT Xold,(Y2k&(Xold)>>10) TO X,(Y2k&(X)>>10)'IF Cchoice=2 THEN  PLOT Xold,(Y2k&(Xold)>>10) TO X,(Y2k&(X)>>10)IF Dflag(2) THEN PLOT Xold,(Y2k&(Xold)>>10) TO X,(Y2k&(X)>>10)IF Dflag(3) THEN  FOR I=Xoldp TO X STEP 2:PLOT I,(Y3k&(I)>>10):NEXT IPEN 1,1,1,10CALL MOVETO(X,(Yk&(X)>>10)):CALL LINETO(Mx,My):DELAY 30:CALL LINETO(X,(Yk&(X)>>10)):PEN 1,1,1,8FN PhotoRETURN:"TCDraw":FOR I=Xoldp TO XY1k&(I)=Yk&(I):Y3k&(I)=YoK&+MCFactor*(Y1k&(I)-YoK&)/(I-Xo)NEXT IY2k&=YoK&+(DeltayK&*MCFactor)/DeltaxFOR I=Xold+1 TO X:Y2k&(I)=Y2k&:NEXT IRETURN:"MCDraw":FOR I=Xoldp TO XY1k&=Y1k&-(YoK&-Yk&(I))/MCFactor:Y1k&(I)=Y1k&:Y2k&(I)=Yk&(I)Y3k&(I)=YoK&+MCFactor*(Y1k&(I)-YoK&)/(I-Xo)NEXT IRETURN:"ACDraw":FOR I=Xoldp TO XYFactorK&=YoK&-Yk&(I)Y1k&(I)=YoK&-(I-Xo)*YFactorK&/MCFactor:Y3k&(I)=Yk&(I)NEXT IFOR I=Xoldp TO XYFactorK&=Y1k&(I)-Y1k&(I-1)Y2k&(I)=YoK&+YFactorK&*MCFactorNEXT IRETURN:MENU ON:MOUSE ON:DIALOG ON"make3curves":Txt$(1)="Click and drag to draw curve."Txt$(2)="Double click when you are finished."FN Message(200,4,0,0,0,0,2,1,12,0)Dx=SGN(Horizdir):Xlimit=ABS(Horizdir)DOM=MOUSE(0)UNTIL M=0WHILE M=0 AND NOT ExitM=MOUSE(0)WEND  :REM  ***Waits FOR MOUSE BUTTON Press***Mx=MOUSE(1):My=MOUSE(2):GOSUB "StartCurve.CVE":REM  ***sets up start***CALL PENMODE(10):M=0Viewflag=-1:CALL SETCLIP(Draw&)WHILE M<>2 AND M<>-2 AND NOT ExitM=0WHILE M=0 AND NOT ExitM=MOUSE(0)PEN 1,1,1,10CALL MOVETO(X,(Yk&(X)>>10))CALL LINETO(MOUSE(1),MOUSE(2)):DELAY 10:CALL LINETO(X,(Yk&(X)>>10))PEN 1,1,1,8WENDWHILE M=-1 AND NOT ExitMx=MOUSE(1):My=MOUSE(2)Deltax=Mx-X:DeltayK&=(My<<10)-Yk&(X)IF (Deltax>Xlimit) AND (DeltayK&>0 OR NotD)  THEN  GOSUB "Extendline3"M=MOUSE(0)WENDWENDMENU OFF:MOUSE OFF:DIALOG OFFXmax=XCALL SETCLIP(OldRegion&):Viewflag=0:CALL SETCLIP(OldRegion&)SEGMENT RETURNSEGMENT:REM **********************************************************:REM ************************************************************:REM ******************Printtext+its Subroutines*************************DIALOG OFF:MOUSE OFF:MENU OFF"Scroll it"Newline=BUTTON(13)LinesUp=(Oldline-Newline):IF LinesUp=0 THEN RETURNOldline=NewlineCALL TESCROLL(0,FntHt*LinesUp,TeHndl&):RETURN"PrintIt"DEF PAGEIF PRCANCEL THEN RETURN ELSE GOSUB "Cleanup"DEF LPRINT:IF PRCANCEL THEN RETURN ELSE GOSUB "Cleanup"Printing=-1ROUTE #128:PtTeHndl&=0PgeLength=700:'IF FontSize=9 then PgeLength=712 else PgeLength= 739Prt=PEEK WORD(PEEK LONG(PRHANDLE)+24):Prt=Prt>>8:'***1 if imagewriter, 3 if laser.***CALL SETRECT(PtVRect(0),40,60,548,PgeLength):CALL SETRECT(PtDRect(0),40,60,548,2400)PtTeHndl&=FN TENEW(PtDRect(0),PtVRect(0))RHand&=FN GETNAMEDRESOURCE(Txt&,TextScr$)CALL TESETTEXT(PEEK LONG(RHand&)+2,L2,PtTeHndl&)CALL TECALTEXT(PtTeHndl&)FntHt=PEEK WORD(PEEK LONG(PtTeHndl&)+24)PtTxtLength=PEEK WORD(PEEK LONG(PtTeHndl&)+94)Pages=PtTxtLength/PtLines:IF PtTxtLength>(Pages*PtLines) THEN Pages=Pages+1PgeNbr=1WHILE PgeNbr<=Pages'IF PgeNbr>1 THEN ROUTE #128PRINT%(200,25)TextScr$;" Page ";PgeNbr;CALL TEUPDATE(PtVRect(0),PtTeHndl&) IF PgeNbr<Pages THEN CALL TESCROLL(0,-FntHt*PtLines,PtTeHndl&):CLEAR LPRINT'ROUTE #0'IF PgeNbr<Pages THEN CLEAR LPRINT PgeNbr=PgeNbr+1:WENDROUTE #0:CLOSE LPRINT:Printing=0CALL TEDISPOSE(PtTeHndl&):'ROUTE 0:RETURN"Cleanup"WINDOW OUTPUT 1:FN Refresh:WINDOW OUTPUT 3:CALL TEUPDATE(VRect(0),TeHndl&)Wptr&=WINDOW(14):CALL DRAWCONTROLS(Wptr&)RETURN:REM                ***Reads text from disk and prints it***"Printtext": REM (Title$,TextScr$) "MOUSE OFF:DIALOG OFFOldline=0:Reading=1:Istart=-1:TEStatus=1:FN PhotoWINDOW #3,Title$,(Wind3L,Wind3T)-(Wind3L+426,Wind3T+280),5DIALOG OND0=DIALOG(0)DIALOG OFFTxt&=(ASC("T")<<24)+(ASC("E")<<16)+(ASC("X")<<8)+ASC("T")RHand&=FN GETNAMEDRESOURCE(Txt&,TextScr$)L2=PEEK WORD(PEEK LONG(RHand&))LONG IF FontSize=9Lines=20:TEXT 4,9,0,0:PtLines=58:' FntHt=11:CALL SETRECT(VRect(0),5,21,408,253)XELSELines=14:TEXT 1,12,0,0:PtLines=40:'FntHt=16:CALL SETRECT(VRect(0),5,21,408,262)END IFCALL SETRECT(DRect(0),5,21,408,1450)BUTTON #14,1,"Print",(187,264)-(233,277),1TeHndl&=FN TENEW(DRect(0),VRect(0)):CALL TESETTEXT(PEEK LONG(RHand&)+2,L2,TeHndl&)CALL TECALTEXT(TeHndl&):TxtLength=PEEK WORD(PEEK LONG(TeHndl&)+94)FntHt=PEEK WORD(PEEK LONG(TeHndl&)+24)IF TxtLength<Lines THEN TxtLength=0 ELSE TxtLength=TxtLength-LinesSCROLL BUTTON #13,0,0,TxtLength,Lines,(411,-1)-(427,281),0CALL TEUPDATE(VRect(0),TeHndl&):TEStatus=-1DIALOG ONWHILE Reading:   REM***Close box has not been clicked***IF WINDOW(0)<>0 THEN WINDOW #3:Wind3L=-WINDOW(10):Wind3T=-WINDOW(11)DIALOG OFFIF D0=1 AND D1=14 THEN GOSUB "PrintIt":D0=0WENDCALL TEDISPOSE(TeHndl&):TEStatus=1BUTTON CLOSE #13:BUTTON CLOSE #14DIALOG ONWINDOW #1:WINDOW CLOSE #3:TEStatus=0DIALOG OFFSEGMENT RETURNSEGMENT:REM ************************************************************:REM ***********************SetMenu*****************************:REM ***************Draws The Menus******************************"SetMenu.CVE"CALL CLEARMENUBARLONG IF MBHndlcve&=0APPLE MENU "About Price Theory"ControlMenu=1:Mhndl&=FN NEWMENU (ControlMenu,"Control  "):'MENU 1,0,1,"Control"CALL APPENDMENU(Mhndl&,"Start Over;Change Programs;Quit/Q")CALL INSERTMENU(Mhndl&,0)Mhndl&=FN NEWMENU (2,"     "):'MENU 2,0,0,"     ":CALL INSERTMENU(Mhndl&,0)CostMenu=3:Mhndl&=FN NEWMENU (CostMenu,"Cost"):' MENU 3,0,1,"Cost"CALL APPENDMENU(Mhndl&,"Draw Total Cost;Draw Marginal Cost;Draw Average Cost")CALL INSERTMENU(Mhndl&,0)RevenueMenu=4:Mhndl&=FN NEWMENU (RevenueMenu,"Revenue")CALL APPENDMENU(Mhndl&,"Draw Total Revenue;Draw Marginal Revenue;Draw Demand Curve")CALL INSERTMENU(Mhndl&,0)ValueMenu=5:Mhndl&=FN NEWMENU (ValueMenu,"Value")CALL APPENDMENU(Mhndl&,"Draw Total Value;Draw Marginal Value")CALL INSERTMENU(Mhndl&,0)Mhndl&=FN NEWMENU (6,"      "):CALL INSERTMENU(Mhndl&,0)HelpMenu=7:Mhndl&=FN NEWMENU (HelpMenu,"Help")CALL APPENDMENU(Mhndl&,"Instructions;Help/H;MacHints;Projects")CALL INSERTMENU(Mhndl&,0)MBHndlcve&=FN GETMENUBARXELSECALL SETMENUBAR(MBHndlcve&)FN Enable(ControlMenu):FN Enable(CostMenu):FN Enable(RevenueMenu):FN Enable(ValueMenu):FN Enable(HelpMenu)END IFCALL DRAWMENUBAR'IF FontSize=9 THEN HelpSize$="Larger Print" ELSE HelpSize$="Smaller Print"MENU HelpMenu,5,1,HelpSize$RETURN:REM ***********************************************************:REM ***********************************************************:REM     *******This uses the mouse to move a horizontal line or box*********:REM      ******In order to set and mark a vertical value such as price******:MOUSE ON:MENU ON:DIALOG ON"AxisClick.CVE":REM  ***At Top for Segmentation Reasons***Repeatflag=1Txt$(1)="Click on TC axis to set the "+Txt$+"."FN Message(135,12,0,0,0,0,1,1,12,0)M=MOUSE(0):CALL PENMODE(10)WHILE (MOUSE(0)=0 OR MOUSE(4)>UpBOUND! OR MOUSE(4)<LowBOUND! OR ABS(MOUSE(3)-Xclick)>15) AND NOT ExitWENDYis=MOUSE(2):CALL MOVETO(Xos,Yis)CALL LINETO(Xms,Yis):FN PhotoCALL PENMODE(8)RETURN:"SetVert": REM (Xos,Yis,Xms,Dys,Rate!,UpBOUND!,LowBOUND!,Txt$,Repeatflag)"Xos=Xo-10:Yis=Fc!:Xms=Xo-4:Dys=1:UpBOUND!=Ylow:LowBOUND=Yv:Repeatflag=0: REM SHARED Y$,XclickCALL PENSIZE(1,Dys)IF Repeatflag=0 THEN  GOSUB "AxisClick.CVE"Txt$(1)="Click and drag above or below to move the"Txt$(2)=Txt$+". When you are satisfied, double click."FN Message(90,4,0,0,0,0,2,1,12,0)CALL PENMODE(10)M=0WHILE (M<>2 AND M<>-2) AND NOT ExitM=MOUSE(0):Yold=YisIF M<0 THEN  Yis=Yis+(MOUSE(2)-Yis)/RateInv:YUp=Yis-Dyhalf:YDown=YUp+DysCALL MOVETO(Xos,Yold)CALL LINETO(Xms,Yold):CALL MOVETO(Xos,Yis):CALL LINETO(Xms,Yis):FN PhotoWENDCALL PENMODE(8)SEGMENT RETURNSEGMENTREM ********************************************************MENU OFF:MOUSE OFF:DIALOG OFFREM***************************************************************************:REM                           ***B/I Draw*** "ClearStart"Lflag=0:Nlflag=-1:GOSUB "Initialize.BID""Start":Menu1=0:'***!!!***ON MENU GOSUB "Menusub.BID"MENU ON:DIALOG ON   :REM    ***Activitating the Menu***::REM:#######################Main Event Loop for B/I Draw############"MidyardSerpent":       REM ***This whole  program is one endless loop***IF DLoad=-2 THEN GOSUB "ClickedOnStart":DLoad=0:REM***Load after double click***ON D1 GOSUB "BLine","Lock","Lock","Lock","ICurve","AxisTool","MMk","MMk","MMk","Dline","Dcurve","Reverse"IF DLoad=-1 THEN GOSUB "Loadstart":DLoad=0:REM ***Loading***LONG IF DLoad=-3FOR I=1 TO 22:I(I)=0:NEXT I:DLoad=0:D1=Dold:BBlank=-1:Cnbr=0:CRestart=0PEN ,,,11:BOX FILL Xo+1,Yv TO Xh+1,Yo:PEN ,,,8:FN Photo:REM Erases drawing areaEND IFLONG IF DLoad=-4CLS:TEXT 0,12,,0:CALL PENNORMAL:FOR I=1 TO 22:I(I)=0:NEXT I:FOR Ichge=1 TO 12:BUTTON CLOSE Ichge:NEXT Ichge:FN PhotoModule=9:DLoad=0:RETURNEND IFGOTO "MidyardSerpent"REM:##################End of Main Event Loop for B/I Draw############MENU OFF:DIALOG OFF:REM *******************************************************:REM        ***Subroutines for the Main Program Start Here***:REM ****************************************************:REM ****************Initialize*************************SEGMENT"Initialize.BID":PEN 2,2,,8RESTORE 28FOR I=1 TO 12:READ TextScr$(I):TextScr$(I)="Help"+TextScr$(I):NEXT I:DATA BLine,BLine,BLine,BLine,ICurve,AxisTool,Marker,Marker,Marker,LineTool,curvetool,BackSpaceFOR I=1 TO 10:READ I$(I):NEXT I:DATA I1,I2,I3,I4,I5,I6,I7,I8,I9,I10H=1:W=1:Pi!=3.1415                             :REM  ***Height and Width ***Rate!=.2:Rate=20:RateInv=5:REM        ***Sets the rates for dragging  endpoint.***Srate=5                    :REM  ***Sets the rate for scrolling parameters***IChoice=-1:LabelNbr=2CALL GETCLIP(OldRegion&)CLS:GOSUB "ButtonPanel"GOSUB "SetMenu.BID":REM      ***Setting up the Menu***"LoadInit"Menuzero=1IF Nlflag THEN GOSUB "XYaxis":GOSUB "Axis.BID"  ELSE GOSUB "IncLeisureaxis"Length=7:Label$="I"RANDOM(TIMER/10):D1=6 :REM  ***Reseeds random generator; starts with button**FN PhotoSEGMENT RETURNSEGMENT:"ButtonPanel":PEN 1,1,1,8,0FOR I=7 TO 10:Cursr(I,32)=0:Cursr(I,33)=0:NEXT IBOX FILL 3,3 TO 6,297:BOX FILL 3,297 TO 181,300PEN ,,,8BOX FILL 181,0  TO 184,300:BOX FILL 3,0 TO 184,3BOX 12,10 TO 176,115:BOX 11,9 TO 177,116BBX=77:BBY=98:BOX BBX-3,BBY-3 TO BBX+36,115BUTTON 1,1,"B",(BBX,BBY)-(BBX+15,BBY+15),2: REM   ***Budget Line Tool***PLOT BBX+20,BBY TO BBX+20,BBY+13:PLOT  TO BBX+31,BBY+13:PLOT BBX+20,BBY+3 TO BBX+30,BBY+13FOR I=2 TO 17:Screen(I)=0:NEXT IGET (BBX+20,BBY+1)-(BBX+35,BBY+16),Screen(0)FOR I=0 TO 15:Cursr(1,I)=Screen(I+2):Cursr(1,I+16)=Cursr(1,I):NEXT ICursr(1,32)=3:Cursr(1,33)=10BBlank=-1 :REM                                 ***Budget line not drawn flag is set***:REM ***Indifference Curve and axis Buttons***BUTTON 5,1,"",(40,140)-(55,155),2  :REM ***I Curve Tool***TEXT 3,9,:CALL MOVETO(39,179):PRINT"U=":TEXT ,12BOX 35,135 TO 83,181 BUTTON 6,1,"",(110,140)-(125,155),2    :REM ***Axis Tool***PLOT 130,141 TO 144,141:PLOT  TO 144,155:BOX 143,140 TO 146,143GET (130,140)-(146,156),Screen(0)FOR I=0 TO 15:Cursr(6,I)=Screen(I+2):Cursr(6,I+16)=Cursr(6,I):NEXT ICursr(6,32)=1:Cursr(6,33)=14TEXT 4,9,0,0:PRINT%(110,168) "X=":PRINT%(110,178) "Y="TEXT ,12:BOX 105,135 TO 151,181::REM ***These are the Marking Tools***FOR I=0 TO 15:Screen(I+2)=0:NEXT I:REM: **Clearing screen() before using itBUTTON 7,1,"",(30,195)-(45,210),2  :REM ***The X tool***PEN 2,2,,8,:PLOT 50,199 TO 56,205:PLOT 56,199 TO 50,205GET(50,199)-(58,207),Screen(0)FOR I=0 TO 15:Cursr(7,I)=Screen(I+2):Cursr(7,I+16)=Cursr(7,I):NEXT IPEN 1,1BUTTON 8,1,"",(80,195)-(95,210),2 :REM ***O Tool***CIRCLE 102,203,4:CIRCLE 102,203,3GET(98,199)-(107,207),Screen(0)FOR I=0 TO 15:Cursr(8,I)=Screen(I+2):Cursr(8,I+16)=Cursr(8,I):NEXT IBUTTON 9,1,"",(130,195)-(145,210),2  :REM ***¥ Tool***CIRCLE FILL 150,203,2GET(146,199)-(155,207),Screen(0)FOR I=0 TO 15:Cursr(9,I)=Screen(I+2):Cursr(9,I+16)=Cursr(9,I):NEXT I:REM ***These are the Drawing Tools***BUTTON 10,1,"",(49,220)-(64,235),2    :REM ***Line Drawing Tool***PLOT 70,223 TO 84,230:CIRCLE 70,223,1:GET (69,222)-(85,238),Screen(0)FOR I=0 TO 15:Cursr(10,I)=Screen(I+2):Cursr(10,I+16)=Cursr(10,I):NEXT ICursr(10,32)=1:Cursr(10,33)=1BUTTON 11,1,"",(110,220)-(125,235),2  :REM ***Curve Drawing Tool***FOR I=131 TO 145:PLOT I,227+2.51*SIN(Pi!*(I-131)\7):NEXT ICIRCLE 131,227,1:GET(130,224)-(146,240),Screen(0)FOR I=0 TO 15:Cursr(11,I)=Screen(I+2):Cursr(11,I+16)=Cursr(11,I):NEXT ICursr(11,32)=3:Cursr(11,33)=1:REM ***This is the backspace button***BOX 28,250 TO 160,290:BUTTON 12,1,"Backspace",(49,260)-(139,280),1FN PhotoSEGMENT RETURNSEGMENT:REM ***********************************************************:REM          ***This polls the menu and branches accordingly***"Menusub.BID":MENU OFF:Menuzero=MENU(0):MENU:IF Menuzero=255 THEN CALL DRAWMENUBAR:WChoice=FN Warning(2,"")FN MenuC(255,0,0):FN AllMenu(ControlMenu,0,HelpMenu):'MENU 255,0,0 TEXT ,,,1ON Menuzero GOSUB "Control.BID","Null","FileMenu","SetupMenu","AxisMenu" IF Menuzero=HelpMenu THEN GOSUB "HelpMenu.BID"'IF Menuzero=255 THEN WChoice=FN Warning(3,Alert$(3))        :REM ***Apple Menu***FN MenuC(255,0,1):FN AllMenu(1,1,HelpMenu):'MENU 255,0,1RETURN  :REM ***Goes to whichever menu was selected, then returns**:REM ****************File Menu--Saves, Loads, Prints, Clears*************:"Control.BID"Menu1=MENU(1)ON Menu1 GOSUB "ClearChoice","Change","Quit"RETURN:"FileMenu":Menu1=MENU(1)ON Menu1 GOSUB "LoadChoice","SaveChoice","SaveAsChoice","PageSetupChoice","PrintChoice"RETURN :REM ***Goes to a selection on Main Menu***:REM ***********************************************************:REM ************These Are the Alternatives on the File Menu*************MENU OFFSEGMENT"LoadChoice":D0=1:DLoad=-1RETURN:DIALOG OFF:MOUSE OFF:MENU OFF"Loadstart":REM ***This is the loading routine***FN Photo:DIALOG ONF$=FILES$(1,"BIDr",,Vol%)DIALOG OFF:FN Refresh:IF F$="" THEN  D1=Dold:RETURN "ClickedOnStart"PEN ,,,11:BOX FILL 191,3 TO 488,300:BOX FILL 43,12 TO 63,104:PEN ,,,10REM: GOSUB "LoadInit"OPEN "I",#1,F$,,Vol%FN AllMenu(1,0,5)INPUT#1,IChoice,YFactor!,XI,YI,L1Sq!,L2Sq!INPUT#1,Ixo,Iyo,A!,D!INPUT#1,Rsq!,R,Slope!,Px,Py,Inc&INPUT#1,LockNumber:FOR I= 1 TO 4:INPUT#1,Lock(I):NEXT IINPUT#1,CRestart,D1,Dold,Cnbr,NlflagFOR K=1 TO 12+Cnbr:INPUT#1,I(K):NEXT KTEXT 0,12,0,0FOR K=0 TO I(1)INPUT#1,BLinex(K),BLiney(K),BLabl$(K),BVal!(K),Lx(K),Ly(K)NEXT KFOR K=0 TO I(5):INPUT#1,MxI(K),MyI(K):NEXT K             :REM ***I Curve Data***FOR K=0 TO I(6)INPUT#1,MxA(K),MyA(K)NEXT KFOR D=0 TO 2                                                              :REM  ***Mark data***FOR K=0 TO I(D+7):INPUT#1,Markx(D,K),Marky(D,K):NEXT KNEXT DFOR K=0 TO I(10)INPUT#1,Linex1(K),Linex2(K),Liney1(K),Liney2(K)NEXT KFOR C=0 TO Cnbr                                              :REM  ***Free-hand Curve Data***FOR K=0 TO I(11+C):INPUT#1,Xc(C,K),Yc(C,K):NEXT KNEXT CCLOSEIF IChoice>=0 THEN GOSUB "Iicon": REM ON IChoice-3 GOSUB "Setup4","Setup5"IF Nlflag THEN  GOSUB "XYaxis":GOSUB "Axis.BID" ELSE  GOSUB "IncLeisureaxis"PSwitch =1:GOSUB "Redraw"FN PhotoFN AllMenu(ControlMenu,1,HelpMenu):IF IChoice>0 THEN  MENU 4,IChoice,2REM:D1=6SEGMENT RETURNSEGMENTREM:"SaveChoice":DEF OPEN "BIDrPThy"FN Photo: DIALOG ONIF F$="" THEN F$=FILES$(0,"Save screen as what?",".Screen",Vol%)DIALOG OFFFN RefreshIF F$="" THEN  RETURNOPEN "O",1,F$,,Vol%PRINT#1,IChoice;",";YFactor!;",";XI;",";YI;",";L1Sq!;",";L2Sq!PRINT#1,Ixo;",";Iyo;",";A!;",";D!PRINT#1,Rsq!;",";R;",";Slope!;",";Px;",";Py","Inc&PRINT#1,LockNumber:FOR I= 1 TO 4:PRINT#1,Lock(I):NEXT IPRINT#1,CRestart;",";D1;",";Dold;",";Cnbr;",";NlflagFOR K=1 TO 12+Cnbr:PRINT#1,I(K):NEXT KFOR K=0 TO I(1)PRINT#1,BLinex(K);",";BLiney(K);",";BLabl$(K);",";BVal!(K);",";Lx(K);",";Ly(K)NEXT KFOR K=0 TO I(5):PRINT#1,MxI(K);",";MyI(K):NEXT K    :REM  ***I Curve Data***FOR K=0 TO I(6)PRINT#1,MxA(K);",";MyA(K)NEXT KFOR D= 0 TO 2                                    :REM  ***Save marking data***FOR K=0 TO I(D+7):PRINT#1,Markx(D,K);",";Marky(D,K):NEXT KNEXT DFOR K=0 TO I(10)                        :REM  ***Save line drawing data***PRINT#1,Linex1(K);",";Linex2(K);",";Liney1(K);",";Liney2(K)NEXT KFOR C=0 TO Cnbr                    :REM  ***Save Free-hand Curve Data***FOR K= 0 TO I(11+C):PRINT#1,Xc(C,K);",";Yc(C,K):NEXT KNEXT CCLOSERETURN'"SaveAsChoice":FN PhotoF$=FILES$(0,"Save screen as what?",".Screen",Vol%)FN RefreshGOSUB "SaveChoice"SEGMENT RETURNSEGMENT:"ClearChoice":D0=1:DLoad=-3RETURN :"PageSetupChoice"FN PhotoDEF PAGE:IF NOT PRCANCEL THEN SetupFlag=True ELSE BEEPFN RefreshRETURN'"PrintChoice":IF NOT SetupFlag THEN GOSUB "PageSetupChoice":IF PRCANCEL THEN RETURN                FN PhotoDEF LPRINT:IF PRCANCEL THEN RETURN ELSE FN RefreshPrinting=-1:FN RefreshROUTE 128:CLSGOSUB "Redraw":GOSUB "Axis.BID"PRINT%(20,30)"I Curve Number ";IChoicePRINT%(20,50) "Y Factor= ";:PRINT USING "#.##";YFactor!PRINT%(20,70)"Slope= ";:PRINT USING "##.##";Slope!PRINT%(20,90)"X Origin=";XIPRINT%(20,108)"Y Origin=";YIROUTE 0:CLOSE LPRINT:Printing=0SEGMENT RETURNSEGMENTREM: REM: ***Start of Redraw cluster: Main sub at bottom***REM ***These are the subroutines for redrawing the screen, arranged by tool***"ReDCurve"PEN 1,1,,8FOR C=0 TO CbndPLOT Xc(C,0),Yc(C,0):FOR I=1 TO I(11+C)-1PLOT TO Xc(C,I),Yc(C,I)  NEXT INEXT CRETURN"ReDBLine"CALL PENMODE(8):FOR I=0 TO I(1)-1: GOSUB "RevB":NEXT IRETURN"ReDILine"CALL CLIPRECT(CRect(0))FOR I=0 TO I(5)-1:GOSUB "RevI":NEXT ICALL SETCLIP(OldRegion&)RETURN"ReDAxis"CALL PENMODE(10)FOR I=0 TO I(6)-1:GOSUB "RevAxis":NEXT IRETURN"ReDMark"FOR I=0 TO I(D1)-1GOSUB "Mark123" NEXT IRETURN"ReDLine"FOR I=0 TO I(10)-1:GOSUB "Revline":NEXT IRETURN"ReDLabel"FOR I=0 TO I(1)-1Value!=BVal!(I):Label$=BLabl$(I)LONG IF Value!<>0 GOSUB "PutLabel"':'GOSUB "BLabelCreate":PUT(Lx(I),Ly(I)),Budlab(0),PSETEND IFNEXT IRETURN"PutLabel"TEXT 4,9,,1:PEN ,,,8:DDisV=DisV+DisVCALL SETRECT(RectLabel(0),Lx(I),Ly(I),Lx(I)+17+DDisV,Ly(I)+23)CALL ERASERECT(RectLabel(0))GOSUB "FindF$"PRINT%(Lx(I)+3+DisV+DisL,Ly(I)+9) Label$PRINT%(Lx(I)+3,Ly(I)+21) USING F$;Value!PEN 1,1:BOX Lx(I),Ly(I) TO Lx(I)+17+DDisV,Ly(I)+23:PEN ,,,10RETURN"ReLock":TEXT ,12LONG IF PSwitch =1 FOR I=1 TO 3IF Lock(I) THEN BUTTON I+1,2 ELSE BUTTON I+1,1NEXT IEND IFGOSUB "PrintPara"RETURN"Mark1P":MxP=Markx(D,I):MyP=Marky(D,I):PEN 2,2,,8PLOT MxP,MyP TO MxP+6,MyP+6 PLOT MxP+6,MyP TO MxP,MyP+6RETURN"Mark2P":MxP=Markx(D,I):MyP=Marky(D,I):PEN 1,1,,8CIRCLE MxP+4,MyP+4,4:CIRCLE MxP+4,MyP+4,3 RETURN"Mark3P":MxP=Markx(D,I):MyP=Marky(D,I):PEN 1,1,,8CIRCLE FILL MxP+4,MyP+4,2 RETURN:"RevB":PEN 2,2PLOT Xo,BLiney(I) TO BLinex(I),YoRETURN"RevBut":REM ***This is a safety; i(D1)=0 will keep us from ever getting here***RETURN"RevI":PEN 1,1Mx=MxI(I):My=MyI(I)ON IChoice GOSUB "I1Draw","I2Draw","I1Draw","I1Draw","I2Draw"IF IChoice>5 THEN  ON IChoice-5 GOSUB "I6Draw","I7Draw","I8Draw","I9Draw","I10Draw"RETURN"RevAxis":PEN 1,1Mx=MxA(I):My=MyA(I)PLOT Xo,My TO Mx,My TO Mx,YoRETURN"Revline":PEN 1,1,,8:PLOT Linex1(I),Liney1(I) TO Linex2(I),Liney2(I)RETURNREM:REM:              ***This is the main redraw subroutine***"Redraw":MENU OFF:DIALOG OFF:MOUSE OFFIhold=I:Dhold=D:D1hold=D1:Chold=C :REM  ***Storing Variable Values***PEN 1,1,,8IF CRestart THEN  Cbnd=Cnbr ELSE  Cbnd=Cnbr-1IF Cbnd>=0 THEN GOSUB "ReDCurve"IF I(1)>0 THEN GOSUB "ReDBLine":GOSUB "ReDLabel"IF I(5)>0 THEN GOSUB "ReDILine"IF I(6)>0 THEN GOSUB "ReDAxis"FOR D=0 TO 2D1=D+7:FN PhotoIF I(D1)>0 THEN GOSUB "ReDMark"NEXT DIF I(10)>0 THEN GOSUB"ReDLine"PEN 1,1I=Ihold:D=Dhold:D1=D1hold:C=Chold :REM  ***Restoring Variable Values***IF (D1<5 AND NOT Printing)THEN  GOSUB "ReLock"SEGMENT RETURNSEGMENT"Quit":CLOSE:GOSUB "CloseRegions.Mn"ENDRETURN:"Change":FN AllMenu(ControlMenu,0,HelpMenu)D0=1:DLoad=-4SEGMENT RETURNSEGMENT:REM ****************Setup Menu--Chooses I curve form*************MOUSE OFF:DIALOG OFF:MENU OFF"SetupMenu":Wchoice=0IF I(5)>0 THEN  Wchoice=FN Warning(1,"all your indifference curves") IF Wchoice=1 THEN  RETURNI(5)=0:PEN ,,,11:BOX FILL Xo+1,Yv-5 TO Xh+5,Yo:PEN ,,,8:GOSUB "Redraw"IF IChoice>0 THEN FN MenuC(4,IChoice,1)IChoice=MENU(1):FN MenuC(4,IChoice,2)YFactor!=.5+RND(10000)*.0001:PEN ,,,8ON IChoice GOSUB "setup1","setup2","setup3","Setup4","Setup5""Iicon":PEN 1,1,,8PLOT 62,140 TO 62,155:PLOT  TO 77,155:CIRCLE 77,141,12 PLOT 128,64CIRCLE 68,149,1:GET (62,140)-(78,156),Screen(0)FOR I=0 TO 15:Cursr(5,I)=Screen(I+2):Cursr(5,I+16)=Cursr(5,I):NEXT ICursr(5,32)=9:Cursr(5,33)=6PEN ,,,11:BOX FILL 62,157 TO 82,167:PEN ,,,8:TEXT 4,9,1,1PRINT%(61,167) I$(IChoice)BOX 35,135 TO 83,181:BOX 105,135 TO 151,181TEXT 1,12,0BUTTON D1,2FN PhotoRETURN :REM ***Gets us out of the OnMenu Subroutine***:"setup1":Ixo=Xh+.005*RND(10000):Iyo=Yv-.005*RND(10000):XI=Ixo:YI=IyoL1Sq!=(Ixo-Xo)^2+((Iyo-Yv)*YFactor!)^2L2Sq!=(Ixo-Xh)^2+((Iyo-Yo)*YFactor!)^2RETURN"setup2":Ixo=Xh:Iyo=Yv-.005*RND(10000):Iyf=YvRsq!=(Ixo-Xo)^2+((Iyo-Yo)*YFactor!)^2:R=SQR(Rsq!):Ixf=Xh+RSlope!=(Iyf-Iyo)*YFactor!\(Ixf-Ixo):A!=1+Slope!^2:D!=Ixo*Slope!-(Yv+(Iyo-Yv)*YFactor!)RETURN"setup3":Ixo=Xh-.005*RND(10000):Iyo=Yv-.005*RND(10000):XI=Ixo:YI=IyoL1Sq!=(Ixo-Xo)^2+((Iyo-Yv)*YFactor!)^2L2Sq!=(Ixo-Xh)^2+((Iyo-Yo)*YFactor!)^2RETURN"Setup4":Ixo=Xh+10:Iyo=Yv-15:YFactor!=.9:XI=Ixo:YI=IyoL1Sq!=(Ixo-Xo)^2+((Iyo-Yv)*YFactor!)^2L2Sq!=(Ixo-Xh)^2+((Iyo-Yo)*YFactor!)^2RETURN"Setup5":Ixo=Xh:Iyo=Yv-50:Iyf=Yv:YFactor!=1.2Rsq!=(Ixo-Xo)^2+((Iyo-Yo)*YFactor!)^2:R=SQR(Rsq!):Ixf=Xh+RSlope!=(Iyf-Iyo)*YFactor!\(Ixf-Ixo):A!=1+Slope!^2:D!=Ixo*Slope!-(Yv+(Iyo-Yv)*YFactor!)RETURN:REM ****Additional Utility functions can be added in the same way*******:REM *****************This is the Axis Menu************"AxisMenu":SumChoices=0:FOR I=5 TO 10:SumChoices=SumChoices+I(I):NEXT ISumChoices=SumChoices+I(1)+Cnbr-CRestart:WCh=0IF SumChoices >0 THEN WCh=FN Warning(1,"everything you have drawn"):IF WCh=1 THEN  RETURN PEN ,,,11:BOX FILL 191,3 TO 488,300:BOX FILL 43,12 TO 63,104:PEN ,,,10:FN PhotoMenu1=MENU(1)ON Menu1 GOSUB "XYaxis","IncLeisureaxis": IF Nlflag THEN  GOSUB "Axis.BID"FOR I=1 TO 11+Cnbr:I(I)=0:NEXT I:Cnbr=0:CRestart=0RETURN "XYaxis":FN MenuC(5,0,1):FN MenuC(5,1,2):FN MenuC(5,2,1):CALL DRAWMENUBARNlflag=-1:Lflag=0"XyAxisSetup"::Xo=215:Yo=272:Xh=465:Yv=22:HScale=25:VScale=25:HNumber=1:VNumber=1XoPlus2&=(Xo+2)<<10:XhMinus15&=(Xh-15)<<10:YoMinus22&=(Yo-22)<<10CALL SETRECT(CRect(0),Xo+1,Yv,Xh,Yo)GOSUB "Axis.BID":GOSUB "CalcCons"IncMx=9990:IncMn=10: REM Max and Min values for Inc&COLOR 0:BOX FILL 107,158 TO 150,180:COLOR -1: REM Clears out old axis textTEXT 4,9,0,1:PRINT%(110,168) "X="::PRINT%(110,178) "Y=":Axis$="##.#"TEXT ,12:PEN ,,,8:BOX 105,135 TO 151,181Ly1=25:DLy=25:Ly2=Ly1+DLy:Ly3=Ly2+DLyLock(1)=0:Lock(2)=0:Lock(3)=0:LockNumber=0:BBlank=-1Inc&=1000:Px=100:Py=100:Xb=Xo+10*HRat!:Yb=Yo-10*VRat!BUTTON 2,1,"I=",(82,Ly1)-(106,Ly1+16)BUTTON 3,1,"Px=",(80,Ly2)-(108,Ly2+16)BUTTON 4,1,"Py=",(80,Ly3)-(108,Ly3+16)COLOR 0:BOX FILL 108,Ly1-5 TO 172,Ly3+20:BOX FILL 40,Ly1-10 TO 79,Ly3+20:COLOR -1PEN 2,2,,8:BOX 112,Ly1-1 TO  152,Ly1+18  :REM ***Boxes the Parameters***BOX 120,Ly2-1 TO  152,Ly2+18 :BOX 120,Ly3-1 TO  152,Ly3+18 PEN ,,,8FN PhotoRETURN"IncLeisureaxis":FN MenuC(5,2,2):FN MenuC(5,1,1)Nlflag=0:Lflag=-1Xo=225:Yo=272:Xh=465:Yv=22:HScale=28:VScale=25:HNumber=3:VNumber=25XoPlus2&=(Xo+2)<<10:XhMinus15&=(Xh-15)<<10:YoMinus22&=(Yo-22)<<10CALL SETRECT(CRect(0),Xo+1,Yv,Xh,Yo)GOSUB "Axis.BID":GOSUB "CalcCons"IncMx=32000:IncMn=100: REM Max and Min values for Inc&TEXT 4,9,0,1:PRINT%(Xo+66,Yo+12)"Leisure in        hrs/day":TEXT ,,,0COLOR 0:PEN ,,,8:BOX FILL 107,158 TO 150,180:COLOR -1 REM***Clears old axis textTEXT 4,9,0,1:PRINT%(110,168) "L=":PRINT%(110,178) "I=":Axis$="###"BOX 105,135 TO 151,181TEXT ,12Lock(1)=0:Lock(2)=0:Lock(3)=-1:Lock(4)=0:LockNumber=1:BBlank=-1Px=100:Py=100:Inc&=24*Px:Xb=Xo+24*HRat!:Yb=Yo-(Inc&*VRat!)/100BUTTON 2,2,"Io=",(80,Ly1)-(108,Ly1+16)BUTTON 3,1,"W=",(82,Ly2)-(106,Ly2+16)BUTTON 4,1,"E=",(82,Ly3)-(106,Ly3+16)COLOR 0:BOX FILL 108,Ly1-5 TO 172,Ly3+20:BOX FILL 40,Ly1-10 TO 79,Ly3+20:COLOR -1PEN 2,2,,8:BOX 119,Ly1-1 TO  152,Ly1+18  :REM ***Boxes the Parameters***BOX 119,Ly2-1 TO  152,Ly2+18 :BOX 112,Ly3-1 TO  152,Ly3+18 PEN 1,1FN PhotoRETURN'***Here and elsewhere, an extra K means a factor of 1024 for integer representation***"CalcCons":'***This is a subroutine of XY axis and IncLeisureaxis.***HRat!=HScale\HNumber:VRat!=VScale\VNumberVHProd=VScale*HScaleHInvKK&=(1024*1024)/HScale:VInvKK&=(1024*1024)/VScaleVHProdInvKK=(1024*1024)/(HScale*VScale):VHProdK&=1024*VScale*HScaleVHRatK=(1024*VScale)/HScale:HVRatK=(1024*HScale)/VScaleRETURN:REM *****************This is the Help Menu************"HelpMenu.BID":Menu1=MENU(1)ON Menu1 GOSUB "Instruction.BID","Help.BID","MacHints.BID","Projects.BID"IF Menu1=5 THEN GOSUB "ChangeFontSize" ELSE GOSUB "Printtext"::REM **********************************************************:REM **************These are the Alternatives on the Help Menu*********"Instruction.BID":Title$="Instructions":TextScr$="Instructions.bid"RETURN"Help.BID":IF (Lflag AND D1< 5) THEN  Title$="Help":TextScr$="HelpLBLine.bid":RETURNTitle$="Help":TextScr$=TextScr$(D1)+".Bid"RETURN"MacHints.BID":Title$="MacHints":TextScr$="MacHints"RETURN"Projects.BID":Title$="Projects":TextScr$="Projects.bid"RETURN:REM ************************************************************:REM ****************These are the tools******************:REM  ***Main tool routine at bottom, for Memory Management (Segment Return)SEGMENTREM ---------------------------------------------------------------------- MENU OFF:DIALOG OFF:MOUSE OFF:'MENU ON:DIALOG ON:MOUSE ON"Blabel":IF Yb>Yo-25 OR Xb<Xo+15 THEN BVal!(I(Dold))=0:RETURNIF LabelNbr=0 THEN Value!=Inc!:IF Nlflag THEN Label$="I" ELSE Label$="Io"IF LabelNbr=1 THEN Value!=Px!:IF Nlflag THEN Label$="Px" ELSE Label$="W"LONG IF LabelNbr=2IF Nlflag THEN Value!=Py!:Label$="Py" ELSE Value!=E!:Label$="E"END IFGOSUB "BLabelCreate"Lx&=(Xo+2)<<10:Ly&=Yb<<10:PUT (Lx&>>10,Ly&>>10),Budlab(0)Slopex&=((Xb-Xo)<<10)/SQR((Xb-Xo)^2+(Yo-Yb)^2)Slopey&=((Yo-Yb)<<10)/SQR((Xb-Xo)^2+(Yo-Yb)^2)M=0MENU ON:DIALOG ON:MOUSE ONWHILE M<>2 AND M<>-2 AND D0<>1M=MOUSE(0):M1=MOUSE(1):M2=MOUSE(2):FN ChangeCursor(M1<Xo-26 OR M1>Xh+26 OR M2<Yv-20 OR M2>Yo+28)WHILE M=-1 AND D0<>1 :REM    ***Button is down***M=MOUSE(0):M1=MOUSE(1):M2=MOUSE(2)MOUSE OFF:DIALOG OFF:MENU OFFFN ChangeCursor(M1<Xo-26 OR M1>Xh+26 OR M2<Yv-20 OR M2>Yo+28)PUT (Lx&>>10,Ly&>>10),Budlab(0):'FN PhotoM1&=M1<<10:M2&=M2<<10:Dlab=(M2&<Ly&)*(M1&<Lx&)+(M2&>Ly&+15000)*(M1&>Lx&+15000)Dlab=Dlab*((M1&+M2&-Lx&-Ly&)>>14)Lx&=Lx&+Dlab*Slopex&:Ly&=Ly&+Dlab*Slopey&LONG IF Lx&>XhMinus15& OR Ly&>YoMinus22& OR Lx&<XoPlus2&Lx&=Lx&-Dlab*Slopex&:Ly&=Ly&-Dlab*Slopey&END IFPUT (Lx&>>10,Ly&>>10),Budlab(0):'FN PhotoWENDFN PhotoWENDMENU OFF:DIALOG OFF:MOUSE OFFFN Debounce PUT (Lx&>>10,Ly&>>10),Budlab(0)I=I(Dold):IF D0=1 THEN  BVal!(I)=0:RETURN PUT (Lx&>>10,Ly&>>10),Budlab(0),PSETBLabl$(I)=Label$:BVal!(I)=Value!:Lx(I)=Lx&>>10:Ly(I)=Ly&>>10:FN PhotoRETURNREM:---------------------------------------------------------------MENU OFF:DIALOG OFF:MOUSE OFF"BLabelCreate":GOSUB "FindF$"XLab=14:Ylab=90TEXT 4,9,,1:PRINT%(XLab+3+DisV+DisL,Ylab+9) Label$PRINT%(XLab+3,Ylab+21) USING F$;Value!PEN 1,1:DDisV=DisV+DisV:BOX XLab,Ylab TO XLab+17+DDisV,Ylab+23GET (XLab,Ylab)-(XLab+17+DDisV,Ylab+23),Budlab(0)PEN ,,,11:BOX FILL XLab,Ylab TO XLab+17+DDisV,Ylab+23:PEN ,,,10RETURN:"FindF$"IF Value!>9.95 THEN  F$="##":DisV=0 ELSE  F$="#.#":DisV=3IF Value!>99.49 THEN F$="###":DisV=3IF Value!<-9.95 THEN F$="###":DisV=3 ELSE IF Value!<-.95 THEN F$="##":DisV=0IF Value!<-99.49 THEN F$="####":DisV=6IF  Label$="I"OR Label$="W" THEN  DisL=3 ELSE  DisL=0RETURN::REM ****These are the Subroutines for displaying Income and Prices*****"NewParameters":ON LockNumber+1 GOSUB "0Lock","1Lock","2Lock","3Lock","3Lock"GOSUB "PrintPara"RETURNREM:"0Lock":Px=(Inc&*HRat!)/(Xb-Xo):Py=(Inc&*VRat!)/(Yo-Yb)IF Px>990 THEN Px=990:GOSUB "PxLocked"IF Px<10 THEN Px=10:GOSUB "PxLocked"IF Py>990 THEN Py=990:GOSUB "PyLocked"IF Py<10 THEN Py=10:GOSUB "PyLocked"RETURN:"1Lock":IF Lock(1) THEN GOSUB "ILocked"IF Lock(2) THEN  GOSUB "PxLocked"IF Lock(3) THEN GOSUB "PyLocked"RETURN:"ILocked":Px=(Inc&*HRat!)/(Xb-Xo)LONG IF Px>990 OR Px<10IF Px>990 THEN Px=990 ELSE IF Px<10 THEN Px=10GOSUB "PyFree"END IFPy=(Inc&*VRat!)/(Yo-Yb)LONG IF Py>990 OR Py<10IF Py>990 THEN Py=990 ELSE IF Py<10 THEN Py=10GOSUB "PxFree"END IFRETURN"PxLocked":Inc&=(Px*(Xb-Xo))/HRat!LONG IF Inc&>IncMx OR Inc&<IncMnIF Inc&>IncMx THEN  Inc&=IncMx ELSE IF Inc&<IncMn THEN Inc&=IncMnGOSUB "PyFree"REM: Xb=Xo+Inc&*HRat!/PxREM: If Xb>Xh then Xb=Xh else if Xb<Xo+3 then Xb=Xo+3REM: If Xb=Xh or Xb=Xo+3 then Px=(Inc&*HRat!)/(Xb-Xo)END IFPy=(Inc&*VRat!)/(Yo-Yb)LONG IF Py>990 OR Py<10IF Py>990 THEN Py=990 ELSE IF Py<10 THEN Py=10GOSUB "IFree"REM: Yb=Yo-Inc&*VRat!/PyREM: If Yb<Yv then Yb=Yv else If Yb>Yo-3 then Yb=Yo-3END IFRETURN"PyLocked":Inc&=(Py*(Yo-Yb))/VRat!:Px=(Inc&*HRat!)/(Xb-Xo)LONG IF Inc&>IncMx OR Inc&<IncMnIF Inc&>IncMx THEN  Inc&=IncMx ELSE IF Inc&<IncMn THEN Inc&=IncMnGOSUB "PxFree"END IFLONG IF Px>990 OR Px<10IF Px>990 THEN Px=990 ELSE IF Px<10 THEN Px=10GOSUB "IFree"END IFRETURNREM:"2Lock"LONG IF Nlflag OR NOT Lock(4)IF NOT Lock(1) THEN GOSUB "IFree"IF NOT Lock(2) THEN GOSUB "PxFree"IF NOT Lock(3) THEN GOSUB "PyFree"XELSEGOSUB "E&PyLocked"END IFRETURNREM:"IFree"YfromX!=Px*VRat!/HRat!:YfromX!=YfromX!/Py :REM  ***Complicated to avoid rounding***LONG IF DL=0Ycalc=Yo-(Xb-Xo)*YfromX!LONG IF Ycalc>YbYb=YcalcInc&=(Py*(Yo-Yb))/VRat!IF Inc&>IncMx THEN  Inc&=IncMx:Yb=Yo-(Inc&*VRat!)/PyIF Inc&<IncMn THEN  Inc&=IncMn:Yb=Yo-(Inc&*VRat!)/PyXELSEXb=Xo+(Yo-Yb)/YfromX!Inc&=(Py*(Yo-Yb))/VRat!IF Inc&>IncMx THEN  Inc&=IncMx:Xb=Xo+(Inc&*HRat!)/PxIF Inc&<IncMn THEN  Inc&=IncMn:Xb=Xo+(Inc&*HRat!)/PxEND IFXELSEXb=Inc&*HRat!/Px+Xo:Yb=Yo-(Inc&*VRat!)/PyIF Xb>Xh THEN Xb=Xh:Yb=Yo-(Xb-Xo)*YfromX!IF Yb<Yv THEN Yb=Yv:Xb=Xo+(Yo-Yb)/YfromX!IF Xb<Xo+3 THEN Xb=Xo+3:Yb=Yo-(Xb-Xo)*YfromX!IF Yb>Yo-3 THEN Yb=Yo-3:Xb=Xo+(Yo-Yb)/YfromX!Inc&=(Py*(Yo-Yb))/VRat!END IFRETURN:"PxFree"Yb=Yo-(Inc&*VRat!)/PyLONG IF DL=0 Px=(Inc&*HRat!)/(Xb-Xo)IF Px>990 THEN  Px=990:Xb=Xo+(Inc&*HRat!)/PxIF Px<10 THEN  Px=10:Xb=Xo+(Inc&*HRat!)/PxXELSEIF Yb<Yv THEN Yb=Yv:IF DL=1 THEN Inc&=(Py*(Yo-Yb))/VRat! ELSE Py=Inc&*VRat!/(Yo-Yb)IF Yb>Yo-3 THEN Yb=Yo-3:IF DL=1 THEN Inc&=(3*Py)/VRat! ELSE Py=Inc&*VRat!/3Xb=Inc&*HRat!/Px+XoIF Xb>Xh THEN Xb=Xh:Px=(Inc&*HRat!)/(Xb-Xo)IF Xb<Xo+3 THEN Xb=Xo+3:Px=Inc&*HRat!/3END IFRETURN"PyFree"Xb=Xo+Inc&*HRat!/PxLONG IF DL=0Py=(Inc&*VRat!)/(Yo-Yb)IF Py>990 THEN  Py=990:Yb=Yo-(Inc&*VRat!)/PyIF Py<10 THEN  Py=10:Yb=Yo-(Inc&*VRat!)/PyXELSEIF Xb>Xh THEN Xb=Xh:IF DL=1 THEN Inc&=(Px*(Xb-Xo))/HRat! ELSE Px=Inc&*HRat!/(Xb-Xo)IF Xb<Xo+3 THEN Xb=Xo+3:IF DL=1 THEN Inc&=(3*Px)/HRat! ELSE Px=Inc&*HRat!/3Yb=Yo-(Inc&*VRat!)/PyIF Yb<Yv THEN Yb=Yv:Py=Inc&*VRat!/(Yo-Yb)IF Yb>Yo-3 THEN Yb=Yo-3:Py=Inc&*VRat!/3END IFRETURN:"E&PyLocked"E&=Inc&-24*PxLONG IF DL=0Inc&=(100*(Yo-Yb))/VRat!IF Inc&>IncMx THEN Inc&=IncMx:Yb=Yo-VRat!*Inc&/100Px=(Inc&-E&)/24Xb=Xo+HRat!*Inc&\PxLONG IF Xb>XhXb=XhDen!=Xb-24*HRat!:Px=E&*HRat!/Den!Inc&=E&+24*Px:Yb=Yo-VRat!*Inc&/100END IFXELSEXb=Xo+(Inc&*HRat!)/PxYb=Yo-(Inc&*VRat!)/100LONG IF Xb>XhXb=XhDen!=Xh-24*HRat!:Px=E&*HRat!/Den!IF Px>990 THEN Px=990:E&=Px*Den!/HRat!Inc&=E&+24*PxYb=Yo-(Inc&*VRat!)/100XELSEIF Xb<Xo+3 THEN Xb=Xo+3:Inc&=(3*Px)/HRat!:Yb=Yo-(Inc&*VRat!)/100END IFLONG IF Yb<YvYb=YvInc&=(Yo-Yb)*100/VRat!:Px=(Inc&-E&)/24IF Px<10 THEN Px=10:E&=Inc&-24*PxXb=Xo+(Inc&*HRat!)/PxIF Xb>Xh THEN Xb=Xh:Inc&=(100*(Yo-Yb))/VRat!:Px=(Inc&*VRat!)/(Xb-Xo)XELSEIF Yb>Yo-3 THEN Yb=Yo-3:Inc&=300/VRat!:Xb=Xo+(Inc&*HRat!)/PxEND IFEND IFRETURN:"3Lock"Xb=Xo+Inc&*HRat!/PxYb=Yo-Inc&*VRat!/PyLONG IF Xb>Xh OR Xb<Xo+3IF Xb>Xh THEN Xb=Xh ELSE Xb=Xo+3IF DL=1 OR DL=4 THEN Inc&=(Xb-Xo)*Px/HRat!:Yb=Yo-Inc&*VRat!/PyIF DL=2 THEN Px=Inc&*HRat!/(Xb-Xo)END IFLONG IF Yb>Yo-3 OR Yb<YvIF Yb>Yo-3 THEN Yb=Yo-3 ELSE Yb=YvIF DL=1 OR DL=4 THEN Inc&=(Yo-Yb)*Py/VRat!:Xb=Xo+Inc&*HRat!/PxIF DL=3 THEN Py=Inc&*VRat!/(Yo-Yb)END IFRETURNMOUSE ON:DIALOG ON"PrintPara":Inc!=Inc&\100:Px!=Px\100:Py!=Py\100MENU OFFIF Lflag THEN  GOSUB "ParaL" ELSE  GOSUB "ParaXY"FN Photo:PEN ,,,8RETURN"ParaL"TEXT 0,12,0,1IF Inc!>99.49 THEN Lpt=123 ELSE IF Inc!>=9.49 THEN Lpt=127IF Inc!<9.49 THEN Lpt=131PEN 1,1,,11:BOX FILL 122,Ly1+1 TO  150,Ly1+16  :REM ***Erases the Parameters***BOX FILL 122,Ly2+1 TO  150,Ly2+16 :BOX FILL 114,Ly3+1 TO  150,Ly3+16 PRINT%(Lpt,Ly1+13) USING "###"; Inc! IF Px!>.949 THEN Lpt=125 ELSE Lpt=129 PRINT%(Lpt,Ly2+13) USING "#.#"; Px!E!=Inc!-24*Px!    :REM  ***Endowment=Income at 24 hours leisure***IF E!<-99.49 THEN Lpt=116 ELSE IF E!<-9.49 OR E!>99.49 THEN Lpt=120IF (E!<-.49 AND E!>-9.49) OR (E!<99.49 AND E!>9.49) THEN Lpt=124IF E!>-.49 AND E!<9.49 THEN Lpt=128PRINT%(Lpt,Ly3+13) USING "####"; E!TEXT 4,9RETURN"ParaXY"TEXT 0,12,0,1IF Inc!>9.949 THEN Lpt=118 ELSE IF Inc!>=.949 THEN Lpt=122IF Inc!<.949 THEN Lpt=126PEN 1,1,,11:BOX FILL 114,Ly1+1 TO  150,Ly1+16  :REM ***Erases the Parameters***BOX FILL 122,Ly2+1 TO  150,Ly2+16 :BOX FILL 122,Ly3+1 TO  150,Ly3+16 PRINT%(Lpt,Ly1+13) USING "##.#";Inc!IF Px!>.949 THEN Lpt=125 ELSE Lpt=129 PRINT%(Lpt,Ly2+13) USING "#.#";Px!IF Py!>.949 THEN Lpt=125 ELSE Lpt=129 PRINT%(Lpt,Ly3+13) USING "#.#";Py!TEXT 4,9MOUSE OFF:DIALOG OFF:'MENU ONRETURN:REM ***********These are the lock subroutine for the budget line**********"Lock":DL=D1-1:IF DL=3 AND Lflag THEN DL=4D0=0:TEXT ,12:PEN ,,,8LYtop=Ly+DL*DLy+(DL=4)*DLy+1:LXlft=68LONG IF Lock(DL)                           :REM  ***If locked, unlocks**Lock(DL)=0LockNumber=LockNumber-1PEN ,,,11:BOX FILL LXlft,LYtop TO LXlft+11,LYtop+14:PEN ,,,8 :REM  ***Erases lock***D1=Dold  :REM                 *** ready to return whence it came***XELSELock(DL)=-1               :REM  ***If unlocked, locks***LockNumber=LockNumber+1GOSUB "Scroll"  :REM                             ' ***Lets you scroll value***BOX FILL LXlft,LYtop+6 TO LXlft+10,LYtop+13 :REM  ***These draw***PEN 2,2:PLOT LXlft+1,LYtop+1 TO LXlft+1,LYtop+6 :REM  ****the***PLOT LXlft+7,LYtop+1 TO LXlft+7,LYtop+6 :REM         ****padlock***PLOT LXlft+2,LYtop TO LXlft+6,LYtop     :REM  ***************PEN ,,,11:PLOT LXlft+4,LYtop+7 TO LXlft+4,LYtop+9:PEN 1,1,,8'D1=DIALOG(1)          :REM                       ***Sends to new tool***LONG IF D1>4 AND NOT BBlankPEN 1,1,,10:PLOT Xo,Yb:PLOT TO Xb,Yo-1:BBlank=-1END IFEND IFFN PhotoDL=0RETURN:"Scroll":Yctr=DL*DLy+8+(DL=4)*DLy:Xleft=43BOX Xleft,Yctr-21 TO Xleft+20,Yctr+21 :REM  ***Frames scrolling area***MENU OFFPEN 2,2,,8PLOT Xleft+1,Yctr-1 TO Xleft+18,Yctr-1 :REM  ***Horizontal barPLOT Xleft+9,Yctr-4 TO Xleft+9, Yctr-10 TO Xleft+6,Yctr-7 :REM   ***These PLOT Xleft+9,Yctr-10 TO  Xleft+12, Yctr-7  :REM  ***two draw up arrow***PLOT Xleft+9,Yctr+2 TO Xleft+9, Yctr+8 TO Xleft+6,Yctr+5 :REM   ***These PLOT Xleft+9,Yctr+8 TO  Xleft+12, Yctr+5  :REM  ***two draw down arrow***FN PhotoIF Exit THEN RETURNMENU ON:DIALOG ONPEN 1,1,,8D0=0WHILE D0<>1M=MOUSE(0):M1=MOUSE(1):M2=MOUSE(2):'D0=DIALOG(0):ScrollSpd=200 :REM ***Slows scrolling at first***WHILE D0<>1 AND M=-1 AND M1>Xleft AND M1<Xleft+20 AND M2>Yctr-22 AND M2<Yctr+22DPara=Yctr-M2Xbold=Xb:Ybold=YbLONG IF DL=1Inc&=Inc&+DPara*Srate*2IF Inc&<IncMn THEN Inc&=IncMn ELSE IF Inc&>IncMx THEN Inc&=IncMxEND IFLONG IF DL=2Px=Px+DPara*SrateIF Px<10 THEN Px=10 ELSE IF Px>990 THEN Px=990END IFLONG IF DL=3Py=Py+DPara*SrateIF Py<10 THEN Py=10 ELSE IF Py>990 THEN Py=990END IFLONG IF DL=4LONG IF Lock(1) Px=Px-(DPara*Srate)/24IF Px<10 THEN Px=10 ELSE IF Px>990 THEN Px=990XELSEInc&=Inc&+DPara*Srate*2IF Inc&<IncMn THEN Inc&=IncMn ELSE IF Inc&>IncMx THEN Inc&=IncMxEND IFEND IFGOSUB "NewParameters"M=MOUSE(0):M1=MOUSE(1):M2=MOUSE(2)LONG IF BBlank<>-1'***Next line erases old budget line, writes new one***PEN 1,1,,10:PLOT Xo,Ybold:PLOT TO Xbold,Yo-1:PEN 1,1,,10:PLOT Xo,Yb:PLOT TO Xb,Yo-1:FN PhotoEND IFDELAY(ScrollSpd):IF ScrollSpd>9 THEN ScrollSpd=ScrollSpd-10 :REM  ***SCROLL Accelerator***WEND  :REM             ***Bottom of mouse down loop for scrolling***MENU ON:DIALOG ONWEND  :REM           ***Bottom of Scrolling loop; button has been pressed***PEN ,,,11:BOX FILL Xleft,Yctr-22 TO Xleft+20,Yctr+22:FN Photo:REM  ***Erases scrolling area***PEN ,,,8RETURN:"Newstart": REM     ***Subroutine for starting a new budget lineXb=M1:Yb=M2GOSUB "NewParameters"      :REM                ***Updates prices, income, etc.***MENU OFFPEN 1,1,,10:PLOT Xo,Yb:PLOT TO Xb,Yo-1:FN Photo:REM          *** Draws new budget line***BBlank=0                      :REM  ***Notes that budget line has been drawn***RETURN:     REM                      ***End of subroutine for starting a budget line***:REM ***Ends Budget line tool***:DIALOG OFF:MOUSE OFF:MENU OFF"LNbrAsterisk"LabelNbr=(LabelNbr+1) MOD 3PEN ,,,11:BOX FILL 152,Ly1 TO 162,Ly3+16 :REM  ***Erases old * *** TEXT ,,,9PRINT%(154,Ly1+15+LabelNbr*DLy) "*":TEXT ,,,8:FN PhotoRETURN'dialog on:mouse on:menu on:REM                ***This is the main Sub for the budget line***"BLine":BUTTON D1,2:RateD!=Rate!:Dold=D1GOSUB "LNbrAsterisk":FN Photo:REM ***Changes LabelNbr, marks with asterisk ***DIALOG ON:MOUSE ON:MENU ONTEXT ,12M=MOUSE(0):M1=MOUSE(1):M2=MOUSE(2):D0=0WHILE D0<>1  :REM ***Top of loop that waits for a button press***REM **Next line waits for mouse down inside the drawing area or a button pressWHILE (M=0 OR M1<=Xo OR M1>Xh OR M2<Yv OR M2>Yo-2) AND D0<>1         M=MOUSE(0):M1=MOUSE(1):M2=MOUSE(2):'D0=DIALOG(0):FN ChangeCursor(M1<Xo-26 OR M1>Xh+26 OR M2<Yv-20 OR M2>Yo+28)WEND   :REM                                  ***Bottom of mouse up loop***IF BBlank AND D0<>1 THEN GOSUB "Newstart" :REM   ***If no B line, draw onePEN 1,1,,10 :REM  ***Sets drawing to XOR***WHILE M=-1 AND D0<>1             :REM  ***While the mouse button is down***M=MOUSE(0):M1=MOUSE(1):M2=MOUSE(2):'D0=DIALOG(0): ***Leave this one?***FN ChangeCursor(M1<Xo-26 OR M1>Xh+26 OR M2<Yv-20 OR M2>Yo+28)Xbold=Xb:Ybold=Yb:Xb=M1:Yb=M2IF Xb>Xh THEN  Xb=Xh ELSE  IF Xb<Xo+3 THEN  Xb=Xo+3IF Yb<Yv THEN  Yb=Yv ELSE  IF Yb>Yo-3 THEN  Yb=Yo-3GOSUB "NewParameters"      :REM          ***Updates prices, income, etc.***FN ChangeCursor(M1<Xo-26 OR M1>Xh+26 OR M2<Yv-20 OR M2>Yo+28)'***next line erases old budget line, draws new one***PEN 1,1,,10:PLOT Xo,Ybold:PLOT TO Xbold,Yo-1:PEN 1,1,,10:PLOT Xo,Yb:PLOT TO Xb,Yo-1:FN PhotoWEND      :REM                                        ***Bottom of mouse down loop***MENU ON:DIALOG ONLONG IF M=2 OR M=-2BBlank=-1LONG IF I(Dold)<51BLinex(I(Dold))=Xb:BLiney(I(Dold))=Yb:'BLinex(I(D1))=Xb:BLiney(I(D1))=Yb   :REM  ***Remembers B line***PEN 2,2,,8:PLOT Xo,Yb:PLOT TO Xb,Yo:FN Photo :REM  ***Draws in thick budget line***WHILE M<>0M=MOUSE(0)WENDGOSUB "Blabel"  :REM                                   ***Puts Label on Budget line***I(Dold)=I(Dold)+1:'I(D1)=I(D1)+1XELSEWCh=FN Warning(4,"Budget Lines")END IFEND IFWHILE M<>0M=MOUSE(0)WENDWEND :REM                 ***Bottom of loop that waits for a new tool choice***BUTTON Dold,1:'BUTTON D1,1:Dold=D1'D1=DIALOG(1)LONG IF (NOT BBlank) AND D1>4 :REM  *** New tool--not just parameter button***PEN 1,1,,10:PLOT Xo,Yb:PLOT TO Xb,Yo-1:FN Photo :BBlank=-1 :REM   ***erases B line***END IFSEGMENT RETURNSEGMENTREM  ***End of Main Budget Line Subroutine***:REM  __________________________________________:REM ***Begins Indifference Curve Tool***:REM: ****These are the subroutines. Main Sub at bottom of group***"Idraw":PEN 1,1,1,10:TEXT 4,12,0,0MENU OFF:DIALOG OFF:MOUSE OFF '***Mouse off?***CALL CLIPRECT(CRect(0))ON IChoice GOSUB "I1Draw","I2Draw","I1Draw","I1Draw","I2Draw"ON IChoice-5 GOSUB "I6Draw","I7Draw","I8Draw","I9Draw","I10Draw"MOUSE ONCALL SETCLIP(OldRegion&)IF IChoice>5 THEN  GOSUB "PrintU":FN Photo'M=MOUSE(0):'***!!!WHILE M=-1M=MOUSE(0)WENDMOUSE OFFLONG IF M=2 OR M=-2  AND I(5)<50MxI(I(5))=Mx:MyI(I(5))=My:I(5)=I(5)+1:RETURNXELSEIF M=2 OR M=-1 THEN WCh=FN Warning(4,"Indifference Curves")END IFPEN 1,1,,10CALL CLIPRECT(CRect(0))LONG IF (IChoice<6)ON IChoice GOSUB "I1Draw","I2Draw","I1Draw","I1Draw","I2Draw"XELSEON IChoice-5 GOSUB "I6Draw","I7Draw","I8Draw","I9Draw","I10Draw"END IFCALL SETCLIP(OldRegion&)FN PhotoRETURN"I1Draw":Rsq!=(Mx-XI)^2+((My-YI)*YFactor!)^2:R=SQR(Rsq!)GOSUB "I12Draw"RETURN"I2Draw":MyP=Yv+(My-Yv)*YFactor!B2!=Mx+Slope!*(MyP+D!):C!=Mx^2+(MyP+D!)^2-Rsq!XI=(B2!+SQR(B2!*B2!-A!*C!))\A!YI=(Yv+(Iyo-Yv)*YFactor!)+Slope!*(XI-Ixo)YI=Yv+(YI-Yv)/YFactor!IF IChoice=6 THEN  GOSUB "I6Draw":RETURNGOSUB "I12Draw"RETURN"I12Draw":'Indcurve(0)=YI-R\YFactor!:Indcurve(1)=XI-R'Indcurve(2)=YI+R\YFactor!:Indcurve(3)=XI+R'CALL FRAMEARC(Indcurve(0),120,180)Yratio=(128/YFactor!)-128:RATIO 0,Yratio :CIRCLE XI,YI,R+1:RATIO 0,0RETURN"I6Draw":Uk&=FN U6k&((Mx-Xo),(Yo-My)):Xmin=FN X6!((Yo-Yv),Uk&):IF Xmin<0 THEN  Xmin=0Xmax!=FN X6!(1,Uk&):IF Xmax!>(Xh-Xo) THEN  Xmax=Xh-Xo ELSE  Xmax=Xmax!Iy=Yo-FN Y6(Xmin,Uk&)FOR Ix=Xmin+Xo+4 TO Xmax+Xo STEP 4PLOT Ix-4,Iy:Iy=Yo-FN Y6((Ix-Xo),Uk&):PLOT TO Ix,IyNEXT IxIF Ix<>Xmax+Xo THEN  PLOT Ix-4,Iy:PLOT TO Xmax+Xo,Yo-FN Y6(Xmax,Uk&)RETURN:"I7Draw":Uk&=FN U7k&((Mx-Xo),(Yo-My)):Xmin=FN X7!((Yo-Yv),Uk&):IF Xmin<0 THEN  Xmin=0WHILE FN Y7(Xmin,Uk&)<=0:Xmin=Xmin+1:WENDXmax!=FN X7!(1,Uk&):IF Xmax!>(Xh-Xo) THEN  Xmax=Xh-Xo ELSE  Xmax=Xmax!Iy=Yo-FN Y7(Xmin,Uk&)FOR Ix=Xmin+Xo+4 TO Xmax+Xo STEP 4PLOT Ix-4,Iy:Iy=Yo-FN Y7((Ix-Xo),Uk&):PLOT TO Ix,Iy :REM  ***Draws Segment***NEXT IxIF Ix<>Xmax+Xo THEN  PLOT Ix-4,Iy:PLOT TO Xmax+Xo,Yo-FN Y7(Xmax,Uk&)RETURN:"I8Draw":Uk&=FN U8k&((Mx-Xo),(Yo-My)):Xmin=FN X8!((Yo-Yv),Uk&):IF Xmin<1 THEN  Xmin=1WHILE FN Y8(Xmin,Uk&)<=0:Xmin=Xmin+1:WENDXmax!=FN X8!(1,Uk&):IF Xmax!>(Xh-Xo) THEN  Xmax=Xh-Xo ELSE  Xmax=Xmax!Iy=Yo-FN Y8(Xmin,Uk&)FOR Ix=Xmin+Xo+4 TO Xmax+Xo STEP 4PLOT Ix-4,Iy:Iy=Yo-FN Y8((Ix-Xo),Uk&):PLOT TO Ix,Iy :REM ***Draws segmentNEXT IxIF Ix<>Xmax+Xo THEN  PLOT Ix-4,Iy:PLOT TO Xmax+Xo,Yo-FN Y8(Xmax,Uk&)RETURN:REM:"I9Draw":Uk&=FN U9k&((Mx-Xo),(Yo-My)):Xmin=FN X9!((Yo-Yv),Uk&):IF Xmin<0 THEN  Xmin=0Xmax!=FN X9!(1,Uk&):IF Xmax!>(Xh-Xo) THEN  Xmax=Xh-Xo ELSE  Xmax=Xmax!Iy=Yo-FN Y9(Xmin,Uk&)FOR Ix=Xmin+Xo+4 TO Xmax+Xo STEP 4PLOT Ix-4,Iy:Iy=Yo-FN Y9((Ix-Xo),Uk&):PLOT TO Ix,IyNEXT IxIF Ix<>Xmax+Xo THEN  PLOT Ix-4,Iy:PLOT TO Xmax+Xo,Yo-FN Y9(Xmax,Uk&)RETURN:"I10Draw"Uk&=FN U0k&((Mx-Xo),(Yo-My)):Xmin=FN X0!((Yo-Yv),Uk&):IF Xmin<0 THEN  Xmin=0Xmax!=FN X0!(1,Uk&):IF Xmax!>(Xh-Xo) THEN  Xmax=Xh-Xo ELSE  Xmax=Xmax!Iy=Yo-FN Y0(Xmin,Uk&)FOR Ix=Xmin+Xo+4 TO Xmax+Xo STEP 4PLOT Ix-4,Iy:Iy=Yo-FN Y0((Ix-Xo),Uk&):PLOT TO Ix,IyNEXT IxIF Ix<>Xmax+Xo THEN  PLOT Ix-4,Iy:PLOT TO Xmax+Xo,Yo-FN Y0(Xmax,Uk&)RETURN:REM:'DIALOG ON:MENU ON"PrintU":U!=Uk&\1024PEN ,,,11:BOX FILL 51,168 TO 80,178:PEN ,,,10:LONG IF U!>-99.9 AND U!<999.9TEXT 4,9,,1:PRINT%(51,178) USING"###.#"; U!XELSEIF U!>999.9 THEN Over$="+++.+" ELSE Over$="---.-"TEXT 4,9,,1:PRINT%(51,178) Over$END IFTEXT ,12,,0RETURN:REMREM ************Main Program for Indifference Curve Tool***********"ICurve":IF IChoice<=0 THEN D1=Dold:WCh=FN Warning(3,""):RETURNDold=D1'***Fixing this by setting Dold at the beginning, using it for D1 thereafter***MENU ON:DIALOG ON:MOUSE ONM=MOUSE(0):M=0:BUTTON Dold,2:D0=0:I=I(Dold):'BUTTON D1,2:D0=0:I=I(D1)WHILE D0<>1              :REM ***Outer loop--waits for a button press***WHILE M<2 AND M>-2 AND D0<>1:M=0    :REM  ***Next loop--waits for a double click***WHILE M=0 AND D0<>1M=MOUSE(0):'D0=DIALOG(0)M1=MOUSE(1):M2=MOUSE(2)FN ChangeCursor(M1<Xo-26 OR M1>Xh+26 OR M2<Yv-20 OR M2>Yo+28)WENDMx=MOUSE(3):My=MOUSE(4)IF Mx>=Xo AND Mx<=Xh AND My<Yo AND My>Yv AND I(Dold)<50 AND D0<>1 THEN  GOSUB "Idraw"WENDIF D0<>1 THEN  M=0WENDBUTTON Dold,1SEGMENT RETURNSEGMENT:REM ***Ends Indifference Curve Tool***REM: _____________________________________:REM ***Starts Axis Tool***:"AxisTool":M=MOUSE(0):M=0:BUTTON D1,2:D0=0:Dold=D1WHILE D0<>1              :REM ***Outer loop--waits for a button press***WHILE M<>2 AND M<>-2 AND D0<>1:M=0                :REM  ***Next loop--waits for a double click***M=MOUSE(0)WHILE M=0 AND D0<>1 :REM ***Moves around with button up***M=MOUSE(0):'D0=DIALOG(0)Mx=MOUSE(1):My=MOUSE(2)LONG IF Mx<Xo-26 OR Mx>Xh+26 OR My<Yv-20 OR My>Yo+28CALL INITCURSOR:PEN ,,,11:BOX FILL 123,160 TO 149,178:PEN ,,,10:XELSECALL SETCURSOR(Cursr(Dold,0)):GOSUB "AxisVals":'***aged D1***END IFWEND  :REM ***Ends button up loop***Mx=MOUSE(3):My=MOUSE(4)IF Mx>=Xo AND Mx<=Xh AND My<Yo AND My>Yv AND I(D1)<50 AND D0<>1 THEN  GOSUB "AxisLines"WEND :REM ***Ends "Wait for Double click" loop***IF D0<>1 THEN  M=0:'D0=DIALOG(0):WEND  :REM ***Ends "Wait for Button click" loop***LONG IF I(Dold)>0:'LONG IF I(D1)>0Mx=MxA(I(Dold)-1):My=MyA(I(Dold)-1):GOSUB "AxisVals" :'***aged D1***XELSEPEN ,,,11:BOX FILL 123,160 TO 149,178:PEN ,,,10:FN PhotoEND IFBUTTON Dold,1:'BUTTON D1,1:Dold=D1:D1=DIALOG(1)RETURNREM ***End of Main program for axis*********MENU OFF:"AxisLines":PEN  1,1,1,10GOSUB "AxisVals"MENU OFF:DIALOG OFFWHILE M=-1: REM While mouse is downM=MOUSE(0):Mx=MOUSE(1):My=MOUSE(2)LONG IF Mx>=Xo AND Mx<=Xh AND My<Yo AND My>YvCALL SETCURSOR(Cursr(D1,0))PLOT Xo,My TO Mx,My:PLOT Mx,My TO Mx,Yo-1XELSELONG IF Mx<Xo-26 OR Mx>Xh+26 OR My<Yv-20 OR My>Yo+28:'Outside drawing areaCALL INITCURSOR:PEN ,,,11:BOX FILL 123,160 TO 149,178:PEN ,,,10XELSE CALL SETCURSOR(Cursr(D1,0))END IFEND IFMx=MOUSE(1):My=MOUSE(2)LONG IF Mx>=Xo AND Mx<=Xh AND My<Yo AND My>YvCALL SETCURSOR(Cursr(D1,0))PLOT Xo,My TO Mx,My:PLOT Mx,My TO Mx,Yo-1XELSELONG IF Mx<Xo-26 OR Mx>Xh+26 OR My<Yv-20 OR My>Yo+28CALL INITCURSOR:PEN ,,,11:BOX FILL 123,160 TO 149,178:PEN ,,,10XELSE CALL SETCURSOR(Cursr(D1,0))END IFEND IFWEND '***Ends mouse down loop***MENU OFF:DIALOG OFF:MOUSE OFF:'MENU ONPLOT Xo,My TO Mx,My:PLOT Mx,My TO Mx,Yo-1PEN ,,,10LONG IF (M=2 OR M=-2)IF I(Dold)<50 THEN MxA(I(Dold))=Mx:MyA(I(Dold))=My:I(Dold)=I(Dold)+1:PEN ,,,8:'***aged D***IF I(Dold)=50 THEN WCh=FN Warning(4,"Coordinate Lines")END IFPLOT Xo,My TO Mx,My:PLOT Mx,My TO Mx,Yo-1:PEN ,,,10FN PhotoIF M=2 OR M=-2 THEN FN DebounceRETURN"AxisVals":PEN ,,,11:BOX FILL 123,158 TO 150,178:PEN ,,,10Xval!=(Mx-Xo)*HNumber\HScaleTEXT 4,9,0,1:PRINT%(124,168); USING Axis$;Xval!Yval!=(Yo-My)*VNumber\VScale:PRINT%(124,178); USING Axis$;Yval!TEXT ,12,,0:FN PhotoRETURN::REM ***End of Axis Tool***:REM ***Beginning of three marking tools***:"MMk":Dold=D1DIALOG ON:MENU ONM=MOUSE(0):BUTTON Dold,2:D0=0:WHILE D0<>1:REM ***Outer loop--waits for a button press***WHILE M=0 AND D0<>1 :REM  ***Waits for button to go down***M=MOUSE(0):M1=MOUSE(1):M2=MOUSE(2):'D0=DIALOG(0):FN ChangeCursor(M1<Xo-26 OR M1>Xh+26 OR M2<Yv-20 OR M2>Yo+28) WENDMx=MOUSE(3):My=MOUSE(4)LONG IF Mx>=Xo AND Mx<=Xh AND My<Yo AND My>Yv AND I(Dold)<50 AND D0<>1 IF I(Dold)< 50 THEN  GOSUB "Mark" ELSE WCh=FN Warning(4,"these marks")END IFWHILE M<>0 :REM  ***Waits for button to come back up***M=MOUSE(0):M1=MOUSE(1):M2=MOUSE(2)FN ChangeCursor(M1<Xo-26 OR M1>Xh+26 OR M2<Yv-20 OR M2>Yo+28)WENDWENDBUTTON Dold,1:CALL INITCURSOR:'BUTTON D1,1:Dold=D1:D1=DIALOG(1):RETURNREM:MENU OFF:"Mark":D=Dold-7:I=I(Dold):Markx(D,I)=Mx:Marky(D,I)=MyGOSUB "Mark123"I(Dold)=I(Dold)+1RETURNDIALOG OFF:MENU OFF:MOUSE OFF"Mark123":ON D+1 GOSUB"Mark1P","Mark2P","Mark3P"RETURN:REM ***Ends Marking Tools***:REM ***Begins line drawing tool***MENU ON:DIALOG ON:MOUSE ON"Dline":Dold=D1:BUTTON Dold,2:RateD!=3*Rate!PEN 1,1,,10M=MOUSE(0):D0=0WHILE D0<>1M=MOUSE(0)WHILE M<>-1 AND D0<>1'D0=DIALOG(0)M=MOUSE(0):M1=MOUSE(1):M2=MOUSE(2)FN ChangeCursor(M1<Xo-26 OR M1>Xh+26 OR M2<Yv-20 OR M2>Yo+28)WENDX=MOUSE(3):Y=MOUSE(4)IF X>=Xo AND X<=Xh AND Y<=Yo AND Y>=Yv AND I(Dold)<50 AND D0<>1 THEN  GOSUB "LineDraw"WENDBUTTON Dold,1:'Dold=D1:D1=DIALOG(1)RETURN"LineDraw":MENU OFFM=MOUSE(0):  REM ***Disables the hairtrigger, here and elsewhere***DIALOG OFFPEN 1,1,,10:PLOT X,YWHILE M=-1:  REM ***drag while mouse button is down***M=MOUSE(0):M1=MOUSE(1):M2=MOUSE(2)FN ChangeCursor(M1<Xo-26 OR M1>Xh+26 OR M2<Yv-20 OR M2>Yo+28)Xnew=M1:IF Xnew>Xh THEN  Xnew=Xh ELSE  IF Xnew<=Xo THEN  Xnew=Xo+1Ynew=M2:IF Ynew<Yv THEN  Ynew=Yv ELSE  IF Ynew>=Yo THEN  Ynew=Yo-1PLOT TO X,Y TO Xnew,YnewWENDFN PhotoMENU ON:DIALOG ONWHILE (M<>2 AND M<>-2 AND D0<>1)M=MOUSE(0):'D0=DIALOG(0)M1=MOUSE(1):M2=MOUSE(2)FN ChangeCursor(M1<Xo-26 OR M1>Xh+26 OR M2<Yv-20 OR M2>Yo+28)Mx=M1:My=M2IF M=-1 THEN  GOSUB "MoveEnd.BID":FN PhotoWENDLONG IF I(Dold)<50Linex1(I(Dold))=X:Liney1(I(Dold))=Y:Linex2(I(Dold))=Xnew:Liney2(I(Dold))=YnewI(Dold)=I(Dold)+1XELSEWCh=FN Warning(4,"Curves")END IFRETURNMENU OFF:DIALOG OFF:MOUSE OFF"MoveEnd.BID":Deltax=Mx-X:Deltay=My-Y:RDeltax=Mx-Xnew:RDeltay=My-YnewLDist&=Deltax^2+Deltay^2:RDist&=RDeltax^2+RDeltay^2LONG IF LDist&<RDist& AND LDist&<1000 GOSUB "MoveLeft.BID" XELSEIF RDist&<1000 THEN GOSUB "MoveRt.BID"END IFRETURN:REM **Moves left end of line if cursor is closer to it, otherwise checks right end"MoveRt.BID":PLOT Xnew,Ynew:PLOT Xnew,YnewXnew=Xnew+RDeltax*RateD!IF Xnew>Xh THEN  Xnew=Xh ELSE  IF Xnew<=Xo THEN  Xnew=Xo+1Ynew=Ynew+RDeltay*RateD!IF Ynew<Yv THEN  Ynew=Yv ELSE  IF Ynew>=Yo THEN  Ynew=Yo-1PLOT TO X,Y TO Xnew,YnewRETURN :REM **Moves right end of line"MoveLeft.BID":PLOT X,Y:PLOT X,YX=X+Deltax*RateD!:Y=Y+Deltay*RateD!IF X>Xh THEN  X=Xh ELSE  IF X<=Xo THEN  X=Xo+1IF Y<Yv THEN  Y=Yv ELSE  IF Y>=Yo THEN  Y=Yo-1PLOT TO Xnew,Ynew TO X,Y :REM  **Moves left end of lineRETURN::REM ***End of Line Drawing Tool***:REM ***Beginning of curve drawing tool***:"Dcurve":Dold=D1:BUTTON Dold,2MENU ON:DIALOG ON:MOUSE ONM=MOUSE(0):D0=0WHILE D0<>1IF Cnbr=10  THEN WCh=FN Warning(4,"Curves")M=0WHILE M=0 AND D0<>1M=MOUSE(0):M1=MOUSE(1):M2=MOUSE(2):'D0=DIALOG(0)FN ChangeCursor(M1<Xo-26 OR M1>Xh+26 OR M2<Yv-20 OR M2>Yo+28)WENDIF CRestart THEN GOSUB "Restart" ELSE GOSUB "StartCurve.BID"WENDBUTTON Dold,1:'BUTTON D1,1:Dold=D1:D1=DIALOG(1)RETURN:"Restart":I=I(Dold+Cnbr):X!=Xc(Cnbr,I):Y!=Yc(Cnbr,I)IF I(Dold+Cnbr)<200 AND D0<>1  THEN  GOSUB "CurveDraw.BID"IF I(Dold+Cnbr)=200 THEN WCh=FN Warning(4,"Points on that Curve")RETURN:"StartCurve.BID":IF Cnbr=10 THEN  RETURNX!=MOUSE(1):Y!=MOUSE(2)IF X!<Xo OR X!>Xh OR Y!>Yo OR Y!<Yv OR I(Dold+Cnbr)>199 OR D0=1 THEN   RETURNI=1:CRestart=-1Xc(Cnbr,0)=X!:Yc(Cnbr,0)=Y!:GOSUB "CurveDraw.BID"RETURN:"CurveDraw.BID":M=0:D0=0WHILE D0<>1 AND M<>2 AND M<>-2M=0WHILE M=0 AND D0<>1M=MOUSE(0):M1=MOUSE(1):M2=MOUSE(2):'D0=DIALOG(0)FN ChangeCursor(M1<Xo-26 OR M1>Xh+26 OR M2<Yv-20 OR M2>Yo+28)WENDWHILE M=-1 M=MOUSE(0):M1=MOUSE(1):M2=MOUSE(2)FN ChangeCursor(M1<Xo-26 OR M1>Xh+26 OR M2<Yv-20 OR M2>Yo+28)Mx=M1:My=M2Deltax=Mx-X!:Deltay=My-Y!LONG IF (Mx>Xo AND Mx<Xh AND My>Yv AND My<Yo) AND ((ABS(Deltax)>4  OR ABS(Deltay)>4))GOSUB "ExtendLine.BID"END IFWENDFN Photo'IF D0<>1 THEN  D0=DIALOG(0)WEND'IF D0<>1 THEN  D0=DIALOG(0)I(Dold+Cnbr)=I:IF M=2 OR M=-2 THEN  CRestart=0:GOSUB "SolidCve":Cnbr=Cnbr+1RETURNMOUSE OFF:DIALOG OFF:MENU OFF"ExtendLine.BID":X!=X!+Deltax\Rate:Y!=Y!+Deltay\RateIF X!<Xo THEN  X!=Xo ELSE  IF  X!>Xh THEN  X!=XhIF Y!>Yo THEN  Y!=Yo ELSE  IF Y!<Yv THEN  Y!=YvIF I>199 THEN WCh=FN Warning(4,"points on that line"):RETURNPtX=X!:PtY=Y!IF (PtX=Xc(Cnbr,I-1) AND PtY=Yc(Cnbr,I-1)) THEN  RETURNPEN 1,1,,10:PLOT  PtX,PtY                  :REM   ***Draw next bit of curve***Xc(Cnbr,I)=X!:Yc(Cnbr,I)=Y!:I=I+1RETURN:"SolidCve"PEN 1,1,,8PLOT Xc(Cnbr,0),Yc(Cnbr,0)IF I(D1+Cnbr)<2 THEN RETURNFOR I=1 TO I(D1+Cnbr)-1PLOT TO Xc(Cnbr,I),Yc(Cnbr,I)NEXT IFN PhotoRETURN::REM ***End of Curve Drawing Tool***::REM     *****************End of Tools*******************:REM     ************This is the reverse button*************DIALOG OFF:MOUSE OFF:MENU OFF"Reverse":IF Dold=0 THEN  RETURND1=DoldD=D1-7IF I(D1)=0 THEN  RETURNLONG IF D1=11 AND CRestart GOSUB "RevCurve" XELSEIF D1<>11 THEN I(D1)=I(D1)-1 ELSE  Cnbr=Cnbr-1IF Cnbr=-1 THEN  Cnbr=0:CRestart=0PEN ,,,11:BOX FILL Xo+1,Yv-5 TO Xh+2,Yo:PEN ,,,10PSwitch=1:GOSUB "Redraw"END IFFN PhotoRETURNREM:"RevCurve":LONG IF I(D1+Cnbr)<2 CRestart=0XELSEI(D1+Cnbr)=I(D1+Cnbr)-1:I=I(D1+Cnbr)PEN 1,1,,10:PLOT Xc(Cnbr,I),Yc(Cnbr,I)END IFRETURNREM: *********************************************************:REM *************************Axis*****************************:REM ***Draws in an axis; (xo,yo) is the origin. HScale is the number of dots per***:REM ***mark, Hnumber the number by which each mark increments quantity.****"Axis.BID":NHoriz=(Xh-Xo)/HScale:NVert=(Yo-Yv)/VScale:Y=Yo+1:X=XoXscale=Xo-8:Yscale=Yo+9:Xscale2=Xo-2:Yscale2=Yo+2"PrintingAxis.BID"TEXT 1,9,0,1:PEN ,,,8:REM                 ***Next eight lines draw and label the marks on the axes****FOR I=0 TO NVert STEP 2 :REM ***Vertical Axis***PRINT%(Xscale-20,Y+5) USING"###"; VNumber*I;:BOX FILL Xscale,Y TO Xscale2,Y+2:Y=Y-2*VScaleNEXT IFOR I=0 TO NHoriz STEP 2:                      :REM   ***Horizontal Axis***PRINT%(X-8,Yscale+12) HNumber*I;BOX FILL X-2,Yscale2 TO X,Yscale:X=X+2*HScaleNEXT ITEXT 1,12,1IF Nlflag THEN PRINT%(Xh+6,Yo+5) "X";CALL MOVETO((Xo-4),Yv-5):IF Lflag THEN  PRINT "I" ELSE  PRINT "Y";TEXT ,,0:PEN 3,3,,8PLOT 186,0 TO 186,297 TO 488,297 TO 488,0 TO 186,0BOX FILL Xo-2,Yo TO Xo+1,Yv:BOX FILL Xo-2,Yo TO Xh+1,Yo+3 :REM  ***Draw the axes***TEXT 1,12,0,0:CALL PENNORMAL SEGMENT RETURNSEGMENT:REM ***********************************************************:REM ************************************************************:REM ***********************SetMenu*****************************:REM ***************Draws The Menus******************************"SetMenu.BID":CALL CLEARMENUBARLONG IF MBhndlBI&=0APPLE MENU "About Price Theory"ControlMenu=1:Mhndl&=FN NEWMENU (ControlMenu,"Control")CALL APPENDMENU(Mhndl&,"Clear;Change Programs;Quit/Q")CALL INSERTMENU(Mhndl&,0)Mhndl&=FN NEWMENU (2,"         "):CALL INSERTMENU(Mhndl&,0)FileMenu=3:Mhndl&=FN NEWMENU (FileMenu,"File")CALL APPENDMENU(Mhndl&,"Open;Save...;Save As;Page Setup;Print")CALL INSERTMENU(Mhndl&,0)IMapMenu=4:Mhndl&=FN NEWMENU (IMapMenu,"I Map")CALL APPENDMENU(Mhndl&,"I1;I2;I3;I4;I5;I6;I7;I8;I9;I10")CALL INSERTMENU(Mhndl&,0)AxesMenu=5:Mhndl&=FN NEWMENU (AxesMenu,"Axes")CALL APPENDMENU(Mhndl&,"Y vs X;Income vs Leisure")CALL INSERTMENU(Mhndl&,0)Mhndl&=FN NEWMENU (6,"          "):CALL INSERTMENU(Mhndl&,0)HelpMenu=7:Mhndl&=FN NEWMENU (HelpMenu,"Help")CALL APPENDMENU(Mhndl&,"Instructions;Help/H;MacHints;Projects")CALL INSERTMENU(Mhndl&,0)MBhndlBI&=FN GETMENUBARXELSECALL SETMENUBAR(MBhndlBI&)FN Enable(IMapMenu):FN Enable(AxesMenu):FN Enable(255)END IFCALL DRAWMENUBAR'IF FontSize=9 THEN HelpSize$="Larger Print" ELSE HelpSize$="Smaller Print"MENU HelpMenu,5,1,HelpSize$SEGMENT RETURN:'*****************************************************************************************************:REM                                   ***Main Program DMV***"StartLineDMV"COORDINATE WINDOW : DEF MOUSE = 1 : TEXT 0,12MOUSE OFFModule=3:REM : ***This is the DMV module***GOSUB "Initialize.DMV"ON MENU GOSUB "Menusub.DMV"MENU ON:DIALOG ON   :REM    ***Activitating the Menu***:REM: ******************MAIN LOOP FOR DMV****************"Ouroboros":REM ***This Whole Fershlugginer program is one endless loop***ON Menuzero-1 GOSUB "DSChoice","DSChoice","MonoChoice"IF NOT Exit THEN GOTO "Ouroboros"DIALOG OFF:MENU OFF:CLS:CALL INITCURSORFOR I=1 TO 4:BUTTON CLOSE I:NEXT I:FN PhotoExit=0:Retry=0:Retryflag=0:DRepeat=0LONG IF StartOverCALL SETRECT(ClpRect(0),0,0,520,400):CALL CLIPRECT(ClpRect(0))FN Enable(1):FN Enable(2):FN Enable(3):FN Enable(4):FN Enable(6)CALL DRAWMENUBARMENU 6,5,1,HelpSize$:MENU 2,3,0:MENU 3,3,0:MENU 4,3,0:MENU 6,2,0Module=3:StartOver=0:Menuzero=0:GOTO "Ouroboros"END IFModule=9:RETURN  REM:******************End Of MAIN LOOP FOR DMV****************:"FixedCost":DHelp=7:REM ***Changes help screen***Txt$(1)="You must now set fixed cost. Click above  to increase"Txt$(2)="it, below to decrease it. Double click when satisfied."FN Message (80,5,0,0,0,0,2,1,12,0)GOSUB "SetFCdmv"PEN ,,,11:BOX FILL 80,5 TO 80+Roffset,5+BOffset:PEN ,,,8RETURN:REM *******************************************************MOUSE ON:DIALOG ON"MoveQ":Dq=(MOUSE(1)-Q)/RateInv:Q=Q+DqIF Q>=Xmax THEN  Q=Xmax-1:REM ***Keeps Q from going out of range***IF Q<Xo THEN  Q=Xo:REM           ********In either direction******PEN ,,,10:PLOT Qold,298 TO Qold,Yv:FN PhotoRETURN:REM   ****These are Subroutines for choices from Demand or Supply Menu***"Straight":MENU OFF:MOUSE OFF:DIALOG OFFMENU Menuflag,1,2:MENU Menuflag,2,0DHelp=1:REM ***Changes help screenYnew=Yv:Xmax=Xh:GOSUB "MakeLine" Slope!=(Ynew-Y)\(Xmax-Xo):Y!=YFOR I=Xo TO XmaxY(I)=Y!:IF Pflag THEN Surplus&(I)=Y!<<10Y!=Y!+Slope!NEXT IMENU Menuflag,1,0RETURN:"Curved":MENU Menuflag,2,2:MENU Menuflag,1,0DHelp=2 :REM ***Changes help screenDy=4:Txt$="intercept":CALL INITCURSORYi=FN SetVert((Xo-4),Yi,(Xo-12),1,0)BOX FILL Xo-4,Yi-2 TO Xo-8,Yi+2:FN PhotoXmax=XhGOSUB "MakeCurve"MENU Menuflag,2,0RETURN:"SwapY":FOR I=Xo TO Xmax:SWAP Y(I),Y1(I):NEXT IRETURN::SEGMENT:REM *******************************************************:REM        ***Subroutines for the Main Program Start Here***:REM ****************************************************:REM ****************Initialize*************************"Initialize.DMV":GOSUB "SetMenuDMV": REM      ***Setting up the Menu***:REM ***********Defines fill and cursor patterns***********************RESTORE 50: REM:             Sets the data pointer to the next data statementFOR I=0 TO 3:READ Minus(I),Plus(I):NEXT I   :REM  *****Patterns of +++ and ---***:DATA 248,-2016,0,8706,143,-28926,0,8736:REM **********************Ends pattern definition*******************CURSOR 4:REM                  ***Changes Cursor to a clock face***FOR I=1 TO 7:READ TextScr$(I):TextScr$(I)="Help"+TextScr$(I):NEXT I:DATA Line,Curve,Price,Quantity,Enough,Draw,FCostIQmax=30:REM     ***This sets the maximum number of points permitted***CALL SETRECT(ScrRect(0),0,0,492,301)Xo=35:Yo=265:Xh=460:Yv=60:Hlabel$="Quantity": REM ***Setting**Vlabel$="P ":Prefix$="G":Menuzero=1:Menuflag=1HScale=50:VScale=50:HNumber=10:VNumber=10     :REM  ***the axis parameters**H=2:W=2                             :REM  ***Height and Width of the MV/MC curve***Rate!=.2:RateInv=5:Rate=20:REM        ***Sets the rates for dragging MV P, Q, and D endpoint.***Horizdir=1:Vertdir=0:Dx=2         :REM  ***Curve drawing is to the right, up or down***FCDelay=6:DelayC=6:DelayC2=6  :REM  ***Delay for  messages, first time through***Prefix$=""F$="######"FOR I=1 TO (Xh-Xo)/HScaleLNbr$=STR$(HNumber*I)StWidth(I)=FN STRINGWIDTH(LNbr$)-8NEXT ICALL SETRECT(AxisTst(0),Xo,Yo-12,Xh,Yo+21)CALL INITCURSOR:REM           ***Returns cursor to normal shape***SEGMENT RETURNSEGMENT:REM ************************MENU SUBS***********************************:"Control.DMV":FN AllMenu(1,0,6):Menu1=MENU(1)ON Menu1 GOSUB "StartOver.DMV","OtherProgram.DMV","Quit.DMV"IF Menuflag =1 THEN FN AllMenu(1,1,6) ELSE  MENU 1,0,1:MENU 6,0,1:MENU  Menuflag,0,1RETURN :REM ***Goes to a selection on Main Menu***:"Demand":DHelp=MENU(1)IF DHelp=3 THEN   GOSUB "Prize":RETURN FN AllMenu(3,0,5):MENU 1,1,1:MENU 2,DHelp,2Menuflag=2SorP$="net benefit":SorD$="Demand":MVC$="MV":Y$="P/MV":Prefix$="D"SFactor!=(HNumber*VNumber)\(HScale*VScale):SFactorInv=1/SFactor!:Xclick=XoRETURN :REM ***Gets us out of the OnMenu Subroutine***:"Supply":DHelp=MENU(1)IF DHelp=3 THEN  MENU ControlMenu,0,0:MENU HelpMenu,0,0:GOSUB "AverageCost":MENU ControlMenu,0,1:MENU HelpMenu,0,1:RETURNMENU 2,0,0:MENU 4,0,0:MENU 1,1,1::MENU 3,DHelp,2Menuflag=3SorP$="Economic Profit":SorD$="Supply":MVC$="MC":Y$="P/MC":Prefix$="S"SFactor!=-(HNumber*VNumber)\(HScale*VScale):SFactorInv=1/SFactor!:Xclick=XoRETURN :REM ***Gets us out of the OnMenu Subroutine***:"Monopoly":DHelp=MENU(1)LONG IF DHelp=3 CURSOR 4:MENU ControlMenu,0,0:MENU HelpMenu,0,0GOSUB "SwapY":GOSUB "AverageCost":GOSUB "SwapY"MENU ControlMenu,0,1:MENU HelpMenu,0,1:CALL INITCURSORRETURNEND IFMENU 2,0,0:MENU 3,0,0MENU  5,0,0:MENU ControlMenu,1,1:MENU 4,DHelp,2Menuflag=4SorP$="Monopoly Profit":SorD$="Demand":MVC$="MC":Y$="P/MC":Prefix$="M"SFactor!=-(HNumber*VNumber)\(HScale*VScale):SFactorInv=1/SFactor!:Xclick=XoRETURN :REM ***Gets us out of the OnMenu Subroutine***:MENU OFF:MOUSE OFF:DIALOG OFF"HelpMenu.DMV":FN AllMenu(1,0,6):Menu1=MENU(1)ON Menu1 GOSUB "Instruction.DMV","Help.DMV","MacHints.DMV","Projects.DMV"IF Menu1=5 THEN GOSUB "ChangeFontSize" ELSE GOSUB "Printtext"LONG IF Menuflag =1 FN AllMenu(1,1,6)XELSE MENU 1,0,1:MENU 6,0,1:MENU Menuflag,0,1END IFRETURN::REM ***********************************************************:REM ************These Are the Alternatives on the Main Menu*************"StartOver.DMV":Exit=-1:StartOver=-1RETURN:"OtherProgram.DMV":Exit=-1RETURN:"Quit.DMV":GOSUB "CloseRegions.Mn":WINDOW CLOSE 1ENDRETURN:"Prize":MENU 1,0,0:MENU 6,0,0:MENU 2,3,2Title$="Prize":TextScr$="DpText"GOSUB  "Printtext"MENU 2,3,0:MENU 1,0,1:MENU  6,0,1Menuzero=1RETURN:REM **********************************************************:REM **************These are the Alternatives on the Help Menu*********"Instruction.DMV":Title$="Instructions":TextScr$=Prefix$+"Instructions.dmv"RETURN:"Help.DMV":IF Prefix$="" THEN  Title$="Help":TextScr$="Help.dmv":RETURNTitle$="Help":TextScr$=Prefix$+TextScr$(DHelp)+".dmv"RETURN:"MacHints.DMV":Title$="MacHints":TextScr$="MacHints"RETURN:"Projects.DMV":IF Prefix$="" THEN  Title$="Projects":TextScr$="Projects.dmv":RETURNTitle$="Projects":TextScr$=Prefix$+"Projects.dmv"RETURN:REM:*************The Main Menu subroutine--at bottom for segmentation*****:REM          ***This polls the menu and branches accordingly***"Menusub.DMV":MENUMenuzero=MENU(0):IF Menuzero<6 AND Menuzero>1 THEN  MENU 6,2,1IF Menuzero=255 THEN CALL DRAWMENUBAR:WChoice=FN Warning(2,"")ON Menuzero GOSUB "Control.DMV","Demand","Supply","Monopoly","HelpMenu.DMV","HelpMenu.DMV"SEGMENT RETURN  :REM ***Goes to whichever menu was selected, then returns**SEGMENT:REM ************************************************************::REM *******This set of subroutines is really the main program for D=MV,S=MC********:REM ***********It is the result of choosing the DS Menu******************:REM ******************These are its Sub-Subroutines*****************"DrawDemand":Dy=4:Txt$="intercept"Yi=FN SetVert((Xo-4),Yi,(Xo-12),1,0)BOX FILL Xo-4,Yi-2 TO Xo-8,Yi+2:FN PhotoFOR I=Xo TO Xmax:Y1(I)=Yhigh:NEXT I:Xmax1=XmaxGOSUB "SwapY":GOSUB "MakeCurve":CURSOR 4IF Exit THEN RETURNGOSUB "CheckMonotonicity":SWAP Xmax,Xmax1:GOSUB "SwapY"RETURN:"right":Txt$(1)="Correct"IF Exit THEN RETURNFN Message (170,10,0,0,0,0,1,6,18,16)DELAY 1500DRepeat=0:Retry=0IF MyMono=-1 OR DSflag=2 THEN DELAY 1500:RETURNREM Txt$(1)="Prize"MENU 2,3,1WAVE 1: REM ***Turns on 4 voice sound***SOUND 396,70,150:DELAY 30:SOUND 396,70,150:DELAY 30 :REM  GGSOUND 396,70,150:DELAY 30SOUND 594,700,190:DELAY 200 :REM  GDSOUND 495,70,150:DELAY 30:SOUND 495,70,150:DELAY 30SOUND 495,70,150:DELAY 30SOUND 594,100,190:DELAY 50:SOUND 495,100,200:DELAY 50 :REM  DBSOUND 594,100,215:DELAY 50:SOUND 792,100,230:DELAY 50 :REM  DGSOUND 594,900,255 :REM  DWAVE 0: REM ***Turns off 4 voice sound***PEN 2,2,1,11:BOX FILL 170,5 TO 300,50 :REM : Erases Message areaTEXT 1,18,25,1:PRINT%(180,35)"Prize"PEN 2,2,1,10FOR Ipz=1 TO 40:BOX FILL 170,5 TO 270,50:DELAY 100:NEXT Ipz :REM  ***Inverts Box***TEXT 1,9,0,0:PEN 1,1,1,8:FN PhotoREM: FOR Ipz=1 TO 5:FN Message (150,10,0,0,0,0,1,6,18,25):DELAY 200:NEXT IpzRETURN:"soso":Txt$(1)="Good enough for government work"FN Message (150,10,0,0,0,0,1,0,12,0)DELAY 3000IF Exit THEN RETURNGOSUB "Retry"RETURN:"wrong":GOSUB "WrongFlash":GOSUB "Retry"RETURN:"Retry":Txt$(1)="Do you want to try to draw"Txt$(2)="the "+SorD$+" curve again?"BUTTON CLOSE 1:BUTTON CLOSE 2FN Message (170,5,0,0,70,0,2,1,12,0)BUTTON 1,1,"yes",(105,15)-(133,34)BUTTON 2,1,"no",(137,15)-(165,34):CALL INITCURSORFN WaitForButtonIF Exit THEN RETURNIF D1=2 THEN  DRepeat=0 ELSE  RETURN:'**IF DIALOG(1)=2 THEN  DRepeat=0 ELSE  RETURNTxt$(1)="Do you want to try to find points on the "+SorD$Txt$(2)="curve again, using the same "+MVC$+" curve?"BUTTON CLOSE 1:BUTTON CLOSE 2FN Message (135,5,0,0,70,0,2,1,12,0)BUTTON 1,1,"yes",(70,15)-(98,34)BUTTON 2,1,"no",(102,15)-(130,34)FN WaitForButton:IF D1=2 THEN  Retry=0:' ***IF DIALOG(1)=2 THEN  Retry=0RETURN:"WrongFlash":Txt$(1)="Wrong"FN Message (170,10,0,0,0,0,1,6,18,16)DELAY 1000 RETURN:"Overflow":Txt$(1)="I disagree. That should be more than enough points."Txt$(2)="You are abusing this machine."Txt$(3)="I am reversing your decision."FN Message (130,10,0,0,0,0,3,0,12,0) GET (130,10)-(130+Roffset,10+BOffset),Screen(0)FOR I=1 TO 10PEN ,,,11:BOX FILL 130,10 TO 130+Roffset,10+BOffset:PEN ,,,8DELAY 300PUT (130,10),Screen(0):DELAY 300:NEXT I:FN PhotoRETURN:"AverageCost":CURSOR 4TC=FixedCost*SFactorInvFOR I=Xo+1 TO Xmax STEP 2TC=TC+(Y(I)+Y(I+1)):AC=TC/(I-Xo)IF AC>Yv AND AC<Yo THEN PLOT I,ACNEXT IMENU 3,3,0:CALL INITCURSORRETURN:REM:*****This is the main subroutine of the DS part of the program***::MOUSE OFF:DIALOG OFF:MENU OFF"DSChoice":CURSOR 4:DSflag=Menuflag-1 :REM  **DSFlag is 1 for demand,2 for supply**DHelp=MENU(1):DHelpold=DHelp:REM MENU 7,2,1 '     ***Activates  Help ***Retry=-1:FixedCost=0:Vertdir=0 :REM   ***curves can slope up or down***IQ=0 WHILE Retry AND NOT Exit:REM ***outermost loop--return here to retry with old MV***IF Exit THEN RETURNTxt$(1)="":FN Message(-1,0,0,0,0,0,0,1,12,0) :REM  ***Clear old messagesCLS:GOSUB"Axis"IF Retryflag THEN  PEN 2,2:FN Callcurve(Xmax) ELSE   ON DHelp GOSUB "Straight","Curved"CURSOR 4:MENU Menuflag,1,0MENU Menuflag,2,0   :REM  ***Disable Curve Drawing***D2=2:Xctr=Xo+4:FN Label(MVC$,Xctr,Y(Xctr)+2,0,12,0)CALL OPENRGNPLOT Xo,Y(Xo)+2:YInt&(Xo)=0FOR I=Xo+1 TO XmaxPLOT TO I,Y(I)+2:YInt&(I)=YInt&(I-1)+Y(I)   :REM  ***YInt is integral of Y***NEXT IPLOT TO Xmax, 331 TO Xo,331 TO Xo,Y(Xo)+2CALL CLOSERGN(YHand&)  :REM       **YHand& is handle to region bounded by Y***IF DSflag=2  THEN  GOSUB "FixedCost":REM ***if Supply, set FC***WHILE D2<>1 AND NOT Exit:REM     ******Loop for finding one point starts here*******DHelp=3 :REM ***Changes help screenTxt$="price":IF IQ>0 AND NOT Retryflag THEN  Pflag=1 ELSE  Pflag=0CALL INITCURSORRetryflag=0:FN Photo:REM ***This Chunk sets price***P=FN SetVert(Xo,P,Xmax,2,Pflag):CURSOR 4IF Exit THEN RETURNFOR I=Xo TO Xmax:Y2(I)=P:NEXT IIF IQ>0 THEN  FN Mark (Q(IQ-1),P(IQ-1)):REM         *******This chunk sets quantity****DHelp=4:REM       ***Changes the help screenTxt$(1)="Click on the price line to set quantity"FN WhileMouseUpIF Exit THEN RETURNFN Message (150,10,0,0,0,0,1,1,12,0)CALL INITCURSORMOUSE ON:MENU ON:DIALOG ONWHILE (MOUSE(0)=0 OR MOUSE(3)<Xo OR MOUSE(3)>Xmax OR ABS(MOUSE(4)-P)>15) AND NOT ExitWENDCURSOR 4:Q=MOUSE(1):PEN 1,1,,10MOUSE OFF:MENU OFF:DIALOG OFFPEN 1,1,,10:PLOT Q,298 TO Q,YvFN Fillcurves(Xo,Q):FN Label(MVC$,Xctr,Y(Xctr)+2,0,12,0)TEXT 1,9,0,0:PRINT%(10-10*(DSflag=1),22) SorP$BOX 5,12 TO 85,38TEXT 0,12,0,1LONG IF (Q-Xo)=(2-DSflag)PRINT%(30,35) USING F$;0;XELSEPRINT%(20,35) USING F$; INT(Surplus&/SFactorInv);END IFTEXT 1,,0,0D2=0WHILE D2<>1 AND NOT Exit:REM ***This adjusts quantity***Txt$(1)="Drag the line right or left. Double click when you"Txt$(2)="have the quantity that maximizes "+SorP$+"."FN Message (110,5,0,0,0,0,2,1,12,0):CALL INITCURSORMOUSE ON:MENU ON:DIALOG ONM=MOUSE(0):M=0WHILE M<>2 AND M<>-2 AND NOT ExitM=MOUSE(0):Qold=QFN WhileMouseUpIF Exit THEN RETURNDIALOG OFF:MENU OFF:MOUSE OFF:'   ***!!!???LONG IF M<0 GOSUB "MoveQ":FN Fillcurves(Qold,Q)IF Q<Xctr+30 OR Qold<Xctr+30 THEN FN Label(MVC$,Xctr,Y(Xctr)+2,0,12,0)PEN 1,1,,10:PLOT Q,298 TO Q,YvTEXT 0,12,0,1PEN 1,1,,11:BOX FILL 15,25 TO 75,35:PEN 1,1,,8LONG IF ((Q-Xo)=2-DSflag)PRINT%(30,35) USING F$;0; XELSEPRINT%(20,35) USING F$; INT(Surplus&/SFactorInv)END IFTEXT 1,,0,0END IF FN PhotoWENDTxt$(1)="Are you satisfied that this quantity"Txt$(2)="maximizes "+SorP$+"?"IF Exit THEN RETURNFN Message (190,5,0,0,70,0,2,1,12,0)BUTTON 1,1,"yes",(125,15)-(153,34)BUTTON 2,1,"no",(157,15)-(185,34):CALL INITCURSOR:FN PhotoDIALOG ONFN WaitForButton:D2=D1:'D2=DIALOG(1)DIALOG OFFIF Exit THEN RETURNWEND :REMPEN 1,1,,11:BOX FILL 5,12 TO 85,38:PEN 1,1,,8:FN PhotoFN Fillcurves(Q,Xo):FN Label(MVC$,Xctr,Y(Xctr)+2,0,12,0)PEN 1,1,,10:PLOT Q,298 TO Q,YvDIALOG OFF          CURSOR 4:DHelp=5 :REM        ***Changes the help screen***FN Mark(Q,P): REM    ***Marks a point on the Demand/S Curve***PEN ,,,11:BOX FILL Xtxt,Ytxt TO Xtxt+Deltax,Ytxt+Deltay:PEN ,,,8BUTTON CLOSE 1:BUTTON CLOSE 2Txt$(1)="Do you think you have enough points"Txt$(2)="to determine the "+SorD$+" curve?"FN Message (180,10,0,0,70,0,2,1,12,0)BUTTON 1,1,"yes",(115,15)-(143,34)BUTTON 2,1,"no",(147,15)-(175,34):CALL INITCURSORDIALOG ONFN WaitForButton:BUTTON CLOSE 1:BUTTON CLOSE 2:FN PhotoIF Exit THEN RETURNCURSOR 4:D2=D1:DIALOG OFFQ(IQ)=Q:P(IQ)=P:IQ=IQ+1:IF IQ>IQmax THEN  GOSUB "Overflow":D2=1WEND:REM     ***Sends it back to try another value of P***FN Mark (Q,P):REM    ***Marks a point on the D/S Curve***DHelp=6:REM       ***Changes the help screen***Txt$(1)="Since you have enough points, draw the "+SorD$+" curve."Txt$(2)="To make it easier, I will first clear the screen and  "Txt$(3)="redraw the " +MVC$+" curve and your points. Be patient."BUTTON CLOSE 1:BUTTON CLOSE 2PEN ,,,11:BOX FILL 160,5 TO 450,50:PEN ,,,8IF Exit THEN RETURNFN Message (90,2,0,0,30,0,3,1,12,0)GOSUB "InvertCurve":DRepeat=-1BUTTON 1,1,"OK",(65,20)-(87,BOffset-10):CALL INITCURSORFN WaitForButton:BUTTON CLOSE 1WHILE DRepeat AND NOT ExitCLS:GOSUB "Axis"FOR I=0 TO IQ-1:FN Mark(Q(I),P(I)):NEXT I :REM  ***Puts D Points on Screen***PEN 1,1:FN Callcurve(Xmax)IF Exit THEN RETURNFN Label(MVC$,Xctr,Y(Xctr),1,12,0):CALL INITCURSORGOSUB "DrawDemand"IF Exit THEN RETURNPQuery$=Prefix$+"?":FN Label(PQuery$,Xo+60,Y1(Xo+60),0,12,0)MENU 3,3,1:'  ***Turns ON The Average Cost OptionGOSUB "CompareCurve"IF Exit THEN RETURNStDev!=StDev!-6*(Mono<>-1 AND DSflag=1)ON 1-((StDev!>6)+(StDev!>3)) GOSUB "right","soso","wrong":CURSOR 4BUTTON CLOSE 1:BUTTON CLOSE 2WEND: REM ***This is the loop for redrawing the D/S curve.***Retryflag=Retry:DHelp=DHelpoldWEND: REM ***This is the outermost loop--sends it back with the same MV/MC***PEN 1,1,,11:BOX FILL Xfc,Yfc-12 TO Xfc+37,Yfc+17:PEN 1,1,,8 :REM  ***????****Txt$(1)="You may now try another "+SorD$+" curve, try something else,"Txt$(2)="or quit. Choose your alternative from the appropriate menu."CLS:FN Message (80,10,0,0,0,0,2,1,12,0)MENU 3,3,0CALL INITCURSORMENU Menuflag,1,1:MENU Menuflag,2,1FN AllMenu(1,1,6):Prefix$="":Menuflag=1:Menuzero=1: REM ***Setup for main menu state***SEGMENT RETURNSEGMENT:REM **********************************************************:REM ********This Ends the main subroutine for the demand menu*****************:REM **********************************************************:REM ******************Monopoly MenuChoice Subroutines************:REM ***********************************************************"DrawMC":FOR I=1 TO 3:BUTTON CLOSE I:NEXT ITxt$(1)="Your monopoly may face a Constant, Linear, or"Txt$(2)="Curved marginal cost curve for its output. Choose one.FN Message (85,16,0,0,0,15,2,1,12,0)BUTTON 1,1,"Constant",(100,5)-(165,21)BUTTON 2,1,"Linear",(225,5)-(290,21)BUTTON 3,1,"Curved",(350,5)-(415,21)CALL INITCURSORFN WaitForButtonIF Exit THEN RETURNFOR I=1 TO 3:BUTTON CLOSE I:NEXT I:FN Photo'D2=D1:'DIALOG(1)ON D1 GOSUB "ConstantMC","LinearMC","CurvedMC"RETURN:"ConstantMC":MCcase=0:Txt$="MC curve":Xmaxold=XmaxMC=FN SetVert(Xo,MC,Xmax,2,0):CURSOR 4FOR I=Xo TO Xmax:Y1(I)=MC:NEXT IRETURN:"LinearMC":MCcase=1:Ynew=Yv:Xmaxold=Xmax:Vertdir=0:H=2:W=2:GOSUB "MakeLine":CURSOR 4Slope!=(Ynew-Y)\(Xmax-Xo):Yprecise!=YFOR I=Xo TO Xmax:Y1(I)=Yprecise!:Yprecise!=Yprecise!+Slope!:NEXT IRETURN:"CurvedMC":MCcase=2:Txt$="intercept":Xmaxold=Xmax:Vertdir=0Yi=FN SetVert((Xo-4),Yi,(Xo-12),1,0)BOX FILL Xo-4,Yi-2 TO Xo-8,Yi+2Xmax1=XmaxGOSUB "SwapY":GOSUB "MakeCurve":CURSOR 4:SWAP Xmax,Xmax1:GOSUB "SwapY"SWAP Xmax,Xmax1:Verdir=0:W=2:H=2RETURN:"MonoMove": PEN 1,1,,10:PLOT Xo,P TO Xmax,PFN Fillcurves(Qold,Xo) :REM      ***Erases fill pattern back to Xo***P=Y(Q)+2:FN Fillcurves(Xo,Q) PLOT Xo,P TO Xmax,PCALL SETRECT(ClpRect(0),Xo+1,Yv,Xmax-1,Yo):CALL CLIPRECT(ClpRect(0))PEN 1,2,,8:CALL FRAMERGN(YHand&):CALL FRAMERGN(DHand&)CALL SETRECT(ScrRect(0),0,0,492,301):CALL CLIPRECT(ScrRect(0)):PEN 1,1,,10TEXT 0,12,0,1PEN 1,1,,11:BOX FILL 15,25 TO 75,35:PEN 1,1,,8LONG IF Q=XoPRINT%(30,35) USING F$;0; XELSEPRINT%(20,35) USING F$; INT(Surplus&/SFactorInv);END IFTEXT 1,,0,0:FN PhotoRETURN::REM:****This is the Main Subroutine for Monopoly****"MonoChoice":Txt$(1)="":FN Message(-1,0,0,0,0,0,0,1,12,0):REM  ***Clear old messagesCLS: GOSUB "Axis" Vertdir=-1:MCFlag=2:FixedCost=0:IQ=0:H=2:W=2:Pflag=-1ON DHelp GOSUB "Straight","Curved":XmaxD=Xmax:'***was on D1***!!!CURSOR 4IF Exit THEN RETURNPflag=0 :REM  ***Turns off recording of Y!, to be used in calculating MR***CALL OPENRGNPLOT Xo-2,Y(Xo):PLOT TO Xo,Y(Xo)LONG IF DHelp=2FOR I=Xo+1 TO XmaxPLOT TO I,Y(I)NEXT IXELSEPLOT TO Xmax,Y(Xmax):PLOT TO Xmax+2,Y(Xmax)END IFPLOT TO Xmax+2,Y(Xmax) TO Xmax+2, 331 TO Xo-2,331 TO Xo-2,Y(Xo)CALL CLOSERGN(DHand&)  :REM       **DHand& is handle to region bounded by D***Xctr=Xo+20:FN Label("D",Xctr,Y(Xctr+5),0,12,0)WHILE MCFlag<4 AND NOT Exit:REM ***Outermost loop; Repeating for different MC values***CURSOR 4:DHelp=3  :REM  ***Changes the help screenIF MCFlag<3 THEN  GOSUB "DrawMC" ELSE  PEN 2,2:FN Callcurve(Xmax)IF Exit THEN RETURNCURSOR 4 FN Label("MC",Xmax,Y1(Xmax),1,12,0)CURSOR 4CALL OPENRGNPLOT Xo-2,Y1(Xo):PLOT TO Xo,Y1(Xo):YInt&(Xo)=0LONG IF MCcase=2FOR I=Xo+1 TO XmaxPLOT TO I,Y1(I):YInt&(I)=YInt&(I-1)+Y1(I)   :REM  ***YInt is integral of Y1***NEXT IXELSEFOR I=Xo+1 TO Xmax:YInt&(I)=YInt&(I-1)+Y1(I):NEXT IPLOT TO Xmax,Y1(Xmax)END IFPLOT TO Xmax+2,Y1(Xmax) TO Xmax+2,331 TO Xo-2,331 TO Xo-2,Y1(Xo)CALL CLOSERGN(YHand&)  :REM       **YHand& is handle to region bounded by Y***CALL SETRECT(ScrRect(0),0,0,492,301)CALL SETRECT(ClpRect(0),Xo,Yv,Xmax,Yo):CALL CLIPRECT(ClpRect(0))PEN 1,2,,8:CALL FRAMERGN(YHand&)CALL SETRECT(ScrRect(0),0,0,492,301):CALL CLIPRECT(ScrRect(0)):FN PhotoIF MCFlag>1 THEN  GOSUB "FixedCost"IF Exit THEN RETURNMENU 4,3,1:'   ***Enable the AC item***:REM ***Set Quantity***DHelp=4:REM       ***Changes the help screen Txt$(1)="Click on the quantity axis to set quantity."FN Message (120,10,0,0,0,0,1,1,12,0)CALL INITCURSORMOUSE ON:MENU ON:DIALOG ONWHILE (MOUSE(0)=0 OR MOUSE(3)<Xo OR MOUSE(3)>=Xmax OR ABS(MOUSE(4)-Yo)>15) AND NOT ExitWENDCURSOR 4:Q=MOUSE(1):PEN 1,1,,10PLOT Q,298 TO Q,Yv:P=Y(Q)+2:PLOT Xo,P TO Xmax,P:FN PhotoFN Fillcurves(Xo,Q) CALL SETRECT(ClpRect(0),Xo,Yv,Xmax,Yo):CALL CLIPRECT(ClpRect(0))PEN 1,2,,8:CALL FRAMERGN(YHand&):CALL FRAMERGN(DHand&):PEN 1,1:FN PhotoCALL SETRECT(ScrRect(0),0,0,492,301):CALL CLIPRECT(ScrRect(0))FN Label("D",Xctr,Y(Xctr+5),0,12,0)TEXT 1,9,0,0:PRINT%(10,22) SorP$:TEXT 0,12,0,1:BOX 5,12 TO 85,38:FN PhotoLONG IF Q=Xo PRINT%(30,35) USING F$;0;XELSEPRINT%(20,35) USING F$; INT(Surplus&/SFactorInv);END IFTEXT 1,,0,0D1=0:'***D2=0 !!!IF Exit THEN RETURNWHILE D1<>1 AND NOT Exit:REM ***This adjusts quantity***Txt$(1)="Drag the line right or left. Double click when you"Txt$(2)="have the quantity that maximizes "+SorP$+"."FN Message (115,5,0,0,0,0,2,1,12,0):CALL INITCURSORM=MOUSE(0):M=0:PEN ,,,10WHILE M<>2 AND NOT ExitM=MOUSE(0):Qold=Q:Pold=PFN WhileMouseUpIF M<0 THEN  GOSUB "MoveQ":GOSUB "MonoMove":PEN 1,1,,10:PLOT Q,298 TO Q,YvIF Exit THEN RETURNFN Label("D",Xctr,Y(Xctr+5),0,12,0)WENDDIALOG OFF:MOUSE OFF:MENU OFFFOR I=1 TO 3:BUTTON CLOSE I:NEXT I:FN PhotoIF Exit THEN RETURNTxt$(1)="Are you satisfied that this quantity"Txt$(2)="maximizes monopoly profit?"FN Message (200,5,0,0,70,0,2,1,12,0)BUTTON 1,1,"yes",(135,15)-(163,34)BUTTON 2,1,"no",(167,15)-(195,34):CALL INITCURSORFN WaitForButton:BUTTON CLOSE 1:BUTTON CLOSE 2:FN PhotoIF Exit THEN RETURNWEND :REM            ***Sends it back to find a better value of Q***PEN 1,1,,11:BOX FILL 5,12 TO 85,38:PEN ,,,8 :REM  ***Clears Surplus Box***CURSOR 4:DHelp=5:REM        ***Changes the help screen***FN Mark(Q,P):REM    ***Marks a point on the Demand/S Curve*** Q(IQ)=Q:P(IQ)=Y(Q):MC(IQ)=Y1(Q):D2=1FN MarkX(Q,MC(IQ))PEN ,,,11:BOX FILL Xtxt,Ytxt TO Xtxt+Deltax,Ytxt+Deltay:PEN ,,,8Txt$(1)="Would you like to redo this with a new"Txt$(2)="MC curve, a different value of FC, or both?"FN Message (168,6,4,10,105,5,2,1,12,0)BUTTON 1,1,"MC",(74,8)-(98,27)BUTTON 3,1,"FC",(103,8)-(125,27):BUTTON 2,1,"both",(130,8)-(170,27)BUTTON 4,1,"No",(106,30)-(135,49)CALL INITCURSORFN WaitForButton:CURSOR 4DIALOG ONFOR I=1 TO 4:BUTTON CLOSE I:NEXT I:FN PhotoIF Exit THEN RETURNMCFlag=D1MOUSE OFF:DIALOG OFF:MENU OFFIF MCFlag<4 THEN  IQ=IQ+1:IF IQ>IQmax THEN  GOSUB "Overflow":MCFlag=4CLS:GOSUB "Axis"IF MCFlag<>3 THEN Xmax=XmaxoldPEN 2,2:FN Callcurve(Xmaxold)CURSOR 4:MENU 4,3,0WEND :REM            ***Sends it back to try another MC or FC***IF Exit THEN RETURNDHelp=6:REM       ***Changes the help screen***Txt$(1)="I will now show you the marginal revenue curve and the points"Txt$(2)="you chose. Since profit is maximized for MC=MR, the x's should"Txt$(3)="lie on MR, unless they correspond to an optimal quantity=0."PEN ,,,11:BOX FILL 160,5 TO 450,50:PEN ,,,8FN Message (90,1,0,0,30,0,3,1,12,0)IF Exit THEN RETURNPLOT Xo,Y(Xo)FOR I=Xo+2 TO Xmax-1 STEP 2 S&=Surplus&(I)+(I-Xo)*(Surplus&(I+1)-Surplus&(I))PLOT TO I,(S&>>10):REM ***Plots Marginal Revenue CurveNEXT IXr=Xo+40:MRxr=Y(Xr)+3*(Y(Xr)-Y(Xr-10))FN Label("MR",Xr-10,MRxr+10,0,12,0)FN Label("D",Xmax-10,Y(Xmax)+10,0,12,0)FOR I=0 TO IQ:FN MarkX(Q(I),MC(I)):FN Mark(Q(I),P(I)):NEXT IBUTTON 1,1,"OK",(65,20)-(87,BOffset-10):CALL INITCURSORFN WaitForButton:BUTTON CLOSE 1:FN PhotoTxt$(1)="When you have finished looking, you may use"Txt$(2)="this menu to try again with another demand"Txt$(3)="curve, try something from another menu, or quit."IF Exit THEN RETURNFN Message (130,1,0,0,70,0,3,1,12,0)BUTTON 1,1,"Finished",(65,20)-(127,BOffset-10):CALL INITCURSORFN WaitForButtonBUTTON CLOSE 1:CLS:FN Photo:Menuzero=1:MENU 4,1,1:MENU 4,2,1FN AllMenu(1,1,6):Prefix$="":Menuflag=1:REM  ***Setup for main menu state***SEGMENT RETURNSEGMENTREM::REM **********************************************************:REM ******************This Finishes the menu choice routines************:REM ***********************************************************::REM **********************************************************:REM *****************This Starts the Ex-Subprograms*******************:REM **********************************************************DIALOG OFF:MOUSE OFF:MENU OFF:"CheckMonotonicity" :REM   (y(),xo,xmax,mono)IF Xmax<Xo THEN  SWAP Xmax,XoJ=XoWHILE Y(J)=Y(J+2):J=J+2:WENDIF Y(J)<Y(J+2) THEN  Mono=-1 ELSE   Mono=1FOR I=J+1 TO Xmax-2 STEP 2Mono2=(Y(I)<Y(I+2))-(Y(I)>Y(I+2))IF ABS(Mono-Mono2)=2 THEN  Mono=0:I=XmaxNEXT IIF (Y(Xo)<Y(Xmax)+2) AND Mono=1 AND Menuflag=2 THEN Mono=-1RETURN ::REM ***********************CompareCurve************************"CompareCurve" :REM  (y1(),y3(),xo,xmax,StDeviation!) D&=0FOR I=Xo+1 TO Xmax-3D&=D&+(Y1(I)-Y3(I))*(Y1(I)-Y3(I))NEXT IStDev!=SQR(D&\(Xmax-Xo-6))RETURN:REM ***********************InvertCurve****************************:REM **********************************************************"InvertCurve" :REM   (x(),y(),y3(),xo,xmax,yhigh,ylow,mono)STATICREM SHARED Surplus&(),Menuflag,FixedCost,SFactor!GOSUB "CheckMonotonicity" :REM ***mono tells if y is monotonic***MyMono=MonoIF Mono=-1 AND Menuflag=2 THEN  GOSUB "simpleD":RETURNIF Mono=+1 AND Menuflag=3 THEN  GOSUB "simpleS":RETURNYlow=Y(Xo):Yhigh=Y(Xo):IF Menuflag=3 THEN  SDfactor=-1 ELSE  SDfactor=1FOR I=Xo+1 TO XmaxIF Y(I)<Ylow THEN  Ylow=Y(I) ELSE  IF Y(I)>Yhigh THEN  Yhigh=Y(I)NEXT ISurplus&=FixedCost*SFactorInvIF Menuflag=2 THEN Y(Xmax+1)=Yhigh ELSE Y(Xmax+1)=YlowFOR J=Ylow TO Yhigh:Surplus&(J)=0:X(J)=Xo:NEXT JJ=Y(Xo)FOR I=Xo TO XmaxSign=SGN(Y(I+1)-Y(I))WHILE J<>Y(I+1)Surplus&=Surplus&+Sign*(I-Xo)*SDfactorIF Surplus&>Surplus&(J) THEN  Surplus&(J)=Surplus&:X(J)=IJ=J+SignWENDNEXT IIF Menuflag=2 THEN  X(Yhigh)=Xmax ELSE  X(Yhigh)=XoGOSUB "Invert2Curve" :REM  (x(),y3(),xo,xmax,yhigh,ylow)RETURN"simpleD": REM ***This takes care of the case where MV is montonic and = D***FOR I=Xo TO Xmax:Y3(I)=Y(I):NEXT IYlow=Y(Xo):Yhigh=Y(Xmax)RETURN"simpleS":TC=-FixedCost*SFactorInvXmid=XmaxFOR I=Xo+1 TO XmaxTC=TC+(Y(I+1)-Y(I))*(I-Xo)IF TC<=0 THEN  Xmid=I-1:I=XmaxNEXT IFOR I=Xo TO Xmid:Y3(I)=Y(Xmid):NEXT IFOR I=Xmid+1 TO Xmax:Y3(I)=Y(I):NEXT IRETURN:REM ********************************************************:REM ********************Invert2Curve*************************:REM ********************************************************"Invert2Curve" REM (x(),y(),xo,xmax,yhigh,ylow)STATICREM SHARED MenuflagON Menuflag-1 GOSUB "DInvert2","SInvert2":RETURN"DInvert2":WHILE X(Ylow)=XoYlow=Ylow+1WENDY3(Xo)=Ylow:I=XoFOR J=Ylow TO Yhigh-1WHILE I<>X(J+1)Y3(I)=JI=I+1WENDNEXT JY3(Xmax)=YhighRETURN"SInvert2"WHILE X(Yhigh)=Xo:Yhigh=Yhigh-1:WENDY3(Xo)=Yhigh:I=XoFOR J=Yhigh TO Ylow+1 STEP -1WHILE I<X(J-1)Y3(I)=JI=I+1WENDNEXT JY3(Xmax)=YlowRETURNMOUSE ON:MENU ON:DIALOG ONSEGMENT:REM ***********************MakeCurve*************************:REM *** Uses mouse to draw y=f(x). If Horizdir>o, draw left to right; horizdir****:REM ***gives the minimum delta x which is recognized. If Vertdir>0, only an****:REM ***increasing function is recognized, if <0 only decreasing, if =0, both.****"MakeCurve" :REM  (xmin,yi,Horizdir,Vertdir,w,h,xmax,y(),rate)REM:MENU 1,1,0Txt$(1)="Click and drag to draw curve."Txt$(2)="Double click when you are finished."FN Message (150,10,0,0,0,0,2,1,12,0)X=Xo:Y!=Yi:Y(X)=Yi:PLOT X,Y(X):FN Photo:REM  ***y! accumulates y without rounding.IF Pflag THEN Surplus&(X)=Y!<<10  :REM  ***Accumulates precise Y for MR calculation***Dx=SGN(Horizdir):Xlimit=ABS(Horizdir)PEN W,H,1,8:WHILE M<>0:M=MOUSE(0):WEND :REM  ***Waits for button up****WHILE M<>2 AND M<>-2 AND NOT ExitM=0FN WhileMouseUpWHILE M=-1 AND NOT ExitMx=MOUSE(1):My=MOUSE(2)Deltax=Mx-X:Deltay=My-Y(X)IF ((Deltax*Dx)>Xlimit AND (Deltay*Vertdir)<1)  THEN  GOSUB "Extendline.DMV"M=MOUSE(0)WENDWENDXmax=XRETURN"Extendline.DMV":ABDeltaX=ABS(Deltax)Increment=(ABDeltaX+ABS(Deltay))/RateIF Increment>=ABDeltaX THEN Increment=1: REM***Avoid overshoot***Xold=XFOR I=0 TO IncrementLONG IF X<XmaxX=X+Dx:Y!=Y!+Dx*Deltay\DeltaxIF Y!>Yo+30 THEN Y!=Yo+30 ELSE IF Y!<Yv+4 THEN Y!=Yv+4Y(X)=Y!IF Pflag THEN Surplus&(X)=Y!<<10END IFNEXT I:REM ***Calculate next point***PLOT Xold,Y(Xold) TO X,Y(X):FN Photo REM Draw next bit of curveRETURN:REM **********************************************************::REM *********************MakeLine+its subroutines************************:REM ***Lets user draw a straight line, from one axis to anywhere. If Vertdir>0, ***:REM  ***the line must slope up, if <0 down****"MoveEnd.DMV":Deltax=Mx-Xo:Deltay=My-YTest=(Deltax<20 AND Deltax>-20) AND (Deltay<20 AND Deltay>-20)IF Test THEN   GOSUB "MoveLeft.DMV" ELSE  GOSUB "testrt"RETURN:REM **Moves left end of line if cursor is close to it, otherwise checks right end:"testrt":Deltax=Mx-Xmax:Deltay=My-YnewTest=(Deltax<20 AND Deltax>-20) AND (Deltay<20 AND Deltay>-20)IF Test THEN   GOSUB "MoveRt.DMV"RETURN:REM **Moves right end of line if cursor is close to it:"MoveRt.DMV":PLOT Xmax,Ynew:PLOT Xmax,YnewXmax=Xmax+Deltax*RateD!:IF Xmax>XmaxML THEN  Xmax=XmaxMLYnew=Ynew+Deltay*RateD!:IF Ynew<Ymin THEN  Ynew=YminIF (Vertdir>0 AND Ynew>Y) OR (Vertdir<0 AND Ynew<Y) THEN  Ynew=YPLOT TO Xo,Y TO Xmax,YnewRETURN :REM **Moves right end of line:"MoveLeft.DMV":PLOT Xo,Y:PLOT Xo,Y:Y=Y+Deltay*RateD!IF (Vertdir>0 AND Ynew>Y) OR (Vertdir<0 AND Ynew<Y) THEN  Y=YnewIF Y<Ymin THEN  Y=YminPLOT TO Xmax,Ynew TO Xo,YRETURN: REM **Moves left end of line:"MakeLine" :RateD!=3*Rate!:XmaxML=Xmax:Ymin=YnewCALL PENNORMAL:PEN W,H,,10Txt$(1)="Draw a line by clicking on the vertical axis,"Txt$(2)="dragging to the right and releasing."FN Message (110,10,0,0,0,0,2,1,12,0):CALL INITCURSORM=MOUSE(0)FN WhileMouseUpXmax=MOUSE(1):IF Xmax>XmaxML THEN  Xmax=XmaxMLY=MOUSE(4):IF Y<Ymin THEN  Y=YminXold=Xo:Yold=Y:Xhold=Xo:Yhold=Y:PEN W,H,,10 PLOT Xo,YM=MOUSE(0):Xmax=MOUSE(1):REM ***Disables the hairtrigger, here and elsewhere***WHILE M<>1 AND M<>0 AND  (Xmax<XmaxML+20) AND NOT ExitM=MOUSE(0):Xmax=MOUSE(1):Ynew=MOUSE(2)IF Xmax>XmaxML THEN  Xmax=XmaxMLIF Ynew<Ymin THEN  Ynew=YminIF (Vertdir>0 AND Ynew>Y) OR (Vertdir<0 AND Ynew<Y) THEN  Ynew=YPLOT TO Xo,Y TO Xmax,YnewWENDTxt$(1)="Adjust the line by dragging the endpoints."Txt$(2)="Double click when you are satisfied."FN Message (130,10,0,0,0,0,2,1,12,0)M=0:PEN W,H,,10WHILE (M<>2 AND M<>-2) AND NOT ExitM=MOUSE(0):Mx=MOUSE(1):My=MOUSE(2)IF M<0 THEN  GOSUB "MoveEnd.DMV"WENDMOUSE OFF:MENU OFF:DIALOG OFFSEGMENT RETURNSEGMENT::REM ***********************SetMenu*****************************:REM ***************Draws The Menus******************************"SetMenuDMV"CALL CLEARMENUBARLONG IF MBHndlDMV&=0APPLE MENU "About Price Theory"ControlMenu=1:Mhndl&=FN NEWMENU (ControlMenu,"Control    "):CALL APPENDMENU(Mhndl&,"Start Over;Change Programs;Quit/Q")CALL INSERTMENU(Mhndl&,0)DemandMenu=2:Mhndl&=FN NEWMENU (DemandMenu,"Demand"):CALL APPENDMENU(Mhndl&,"Draw Straight MV;Draw Curved MV;Prize")CALL INSERTMENU(Mhndl&,0)SupplyMenu=3:Mhndl&=FN NEWMENU (SupplyMenu,"Supply"):CALL APPENDMENU(Mhndl&,"Draw Straight MC;Draw Curved MC;Show AC")CALL INSERTMENU(Mhndl&,0)MonopolyMenu=4:Mhndl&=FN NEWMENU (MonopolyMenu,"Monopoly"):CALL APPENDMENU(Mhndl&,"Draw Straight D;Draw Curved D;Show AC")CALL INSERTMENU(Mhndl&,0)Mhndl&=FN NEWMENU (5," "):CALL INSERTMENU(Mhndl&,0)HelpMenu=6:Mhndl&=FN NEWMENU(HelpMenu,"Help")CALL APPENDMENU(Mhndl&,"Instructions;Help/H;MacHints;Projects")CALL INSERTMENU(Mhndl&,0)MENU HelpMenu,2,0:'***,"/HHelp"Mhndl&=FN NEWMENU(7,"")CALL INSERTMENU(Mhndl&,0)MBHndlDMV&=FN GETMENUBARXELSECALL SETMENUBAR(MBHndlDMV&)FN Enable(ControlMenu):FN Enable(DemandMenu):FN Enable(SupplyMenu):FN Enable(MonopolyMenu):FN Enable(HelpMenu)END IFCALL DRAWMENUBARIF FontSize=9 THEN HelpSize$="Larger Print" ELSE HelpSize$="Smaller Print"MENU HelpMenu,5,1,HelpSize$:MENU DemandMenu,3,0:MENU SupplyMenu,3,0:MENU MonopolyMenu,3,0:MENU HelpMenu,2,0SEGMENT RETURNSEGMENT:REM ***********************************************************MOUSE ON:MENU ON:DIALOG ON"PrintFC"IF (FixedCost>=0 AND FixedCost<10) THEN Lpt=14IF FixedCost>9 OR (FixedCost<0 AND FixedCost>-10) THEN Lpt=10IF FixedCost<-9 OR FixedCost>99 THEN Lpt=6IF FixedCost<-99 OR FixedCost>999 THEN Lpt=2PRINT%(Xfc+Lpt,Yfc+13) USING "####";FixedCost;:FN PhotoRETURN"SetFCdmv"DELAY 100TEXT 0,12,0,1:Xfc=450:Yfc=27'***was 21PEN 1,1,,11:BOX FILL Xfc,Yfc-12 TO Xfc+36,Yfc+17:PEN 1,1,,8:FN PhotoPRINT%(Xfc+12,Yfc+1) "FC":FN PhotoGOSUB "PrintFC"BOX Xfc,Yfc-12 TO Xfc+37,Yfc+17:FN PhotoWHILE M<>0:M=MOUSE(0):WEND:CALL INITCURSOR  :REM    ***Waits for Mouse Up***WHILE M<>2 AND M<>-2 AND NOT Exit  :REM   ***Waits for a double click***FN WhileMouseUp:M=MOUSE(0):FCdelay=200:DELAY 200WHILE M=-1 AND NOT ExitM=MOUSE(0):M1=MOUSE(1):M2=MOUSE(2)LONG IF M1>Xfc AND M1<Xfc+36DELAY FCdelayIF Prefix$="S" THEN IQ=0 :REM :***Restarts point count if FC changed***IF FCdelay>19 THEN FCdelay=FCdelay-10FixedCost=FixedCost+(Yfc+2-M2)/10IF FixedCost>9999 THEN FixedCost=9999 IF FixedCost<-999 THEN FixedCost=-999PEN ,,,11:BOX FILL Xfc+1,Yfc+1 TO Xfc+35,Yfc+16:PEN ,,,10:FN PhotoGOSUB "PrintFC"END IFWEND  :REM   ***Bottom of mouse down loop***WEND :REM  ***Bottom of wait for double click loop***WHILE M<>0:M=MOUSE(0):WENDSEGMENT RETURN